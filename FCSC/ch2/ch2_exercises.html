<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Solutions to exercises">

<title>learn-relearn - Exercises</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">learn-relearn</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-first-course-in-stochastic-calculus" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">First Course in Stochastic Calculus</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-first-course-in-stochastic-calculus">    
        <li class="dropdown-header">First Course in Stochastic Calculus</li>
        <li>
    <a class="dropdown-item" href="../../FCSC/ch1/ch1_experiments.html">
 <span class="dropdown-text">Chapter 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../FCSC/ch2/ch2_experiments.html">
 <span class="dropdown-text">Chapter 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../FCSC/ch3/ch3_experiments.html">
 <span class="dropdown-text">Chapter 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../FCSC/ch4/ch4_experiments.html">
 <span class="dropdown-text">Chapter 4</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-probabilistic-machine-learning" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Probabilistic Machine Learning</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-probabilistic-machine-learning">    
        <li class="dropdown-header">Probabilistic Machine Learning</li>
        <li>
    <a class="dropdown-item" href="../../PML/ch2.html">
 <span class="dropdown-text">Probabilistic Machine Learning</span></a>
  </li>  
    </ul>
  </li>
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Chapter Two: Exercises</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">First Course in Stochastic Calculus</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Chapter 1</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch1/ch1_experiments.html" class="sidebar-item-text sidebar-link">Computer Experiments</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch1/ch1_exercises.html" class="sidebar-item-text sidebar-link">Exercises</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">Chapter 2</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch2/ch2_experiments.html" class="sidebar-item-text sidebar-link">Computer Experiments</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch2/ch2_exercises.html" class="sidebar-item-text sidebar-link active">Exercises</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">Chapter 3</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch3/ch3_experiments.html" class="sidebar-item-text sidebar-link">Computer Experiments</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch3/ch3_exercises.html" class="sidebar-item-text sidebar-link">Exercises</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">Chapter 4</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch4/ch4_experiments.html" class="sidebar-item-text sidebar-link">Computer Experiments</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch4/ch4_exercises.html" class="sidebar-item-text sidebar-link">Exercises</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Chapter Two: Exercises</h1>
</div>

<div>
  <div class="description">
    Solutions to exercises
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>
<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#an-example-of-uncorrelated-random-variables-that-are-not-independent" id="toc-an-example-of-uncorrelated-random-variables-that-are-not-independent">2.1 An Example of Uncorrelated Random Variables that are not Independent</a></li>
  <li><a href="#sum-of-exponentials-is-gamma" id="toc-sum-of-exponentials-is-gamma">2.2 Sum of Exponentials is Gamma</a></li>
  <li><a href="#why-sqrt2-pi" id="toc-why-sqrt2-pi">2.3 Why <span class="math inline">\(\sqrt{2 \pi}\)</span>?</a></li>
  <li><a href="#box-muller" id="toc-box-muller">2.4 Box-Muller</a></li>
  <li><a href="#marginally-gaussian-but-not-jointly-gaussian." id="toc-marginally-gaussian-but-not-jointly-gaussian.">2.5 Marginally Gaussian but not Jointly Gaussian.</a></li>
  <li><a href="#pdf-of-brownian-bridge" id="toc-pdf-of-brownian-bridge">2.6 PDF of Brownian Bridge</a></li>
  <li><a href="#the-covariance-of-a-random-vector-is-always-positive-semidefinite" id="toc-the-covariance-of-a-random-vector-is-always-positive-semidefinite">2.7 The Covariance of a Random Vector is Always Positive Semidefinite</a></li>
  <li><a href="#a-linear-transformation-of-gaussian-vector-is-also-gaussian" id="toc-a-linear-transformation-of-gaussian-vector-is-also-gaussian">2.8 A Linear Transformation of Gaussian Vector is Also Gaussian</a></li>
  <li><a href="#iid-decomposition" id="toc-iid-decomposition">2.9 IID Decomposition</a></li>
  <li><a href="#iid-decomposition-1" id="toc-iid-decomposition-1">2.10 IID Decomposition</a></li>
  <li><a href="#iid-decomposition-2" id="toc-iid-decomposition-2">2.11 IID Decomposition</a></li>
  <li><a href="#sec-degenerate-is-li" id="toc-sec-degenerate-is-li">2.12 Degenerate Means Linearly Independent</a></li>
  <li><a href="#iid-decomposition-for-degenerate-vectors" id="toc-iid-decomposition-for-degenerate-vectors">2.13 IID Decomposition For Degenerate Vectors</a></li>
  <li><a href="#brownian-bridge-from-brownian-motion" id="toc-brownian-bridge-from-brownian-motion">2.14 Brownian Bridge From Brownian Motion</a></li>
  <li><a href="#triangle-inequality" id="toc-triangle-inequality">2.15 Triangle Inequality</a></li>
  <li><a href="#the-space-of-integrable-random-variables-is-l1" id="toc-the-space-of-integrable-random-variables-is-l1">2.16 The Space of Integrable Random Variables is <span class="math inline">\(L^1\)</span></a></li>
  <li><a href="#wicks-formula" id="toc-wicks-formula">2.17 Wick’s Formula</a></li>
  </ul>
</nav>
<section id="an-example-of-uncorrelated-random-variables-that-are-not-independent" class="level2">
<h2 class="anchored" data-anchor-id="an-example-of-uncorrelated-random-variables-that-are-not-independent">2.1 An Example of Uncorrelated Random Variables that are not Independent</h2>
<p>Let <span class="math inline">\(X\)</span> be a standard Gaussian. Show that <span class="math inline">\(\Cov(X^2, X) = 0\)</span>.</p>
<p><span class="math display">\[
\Cov(X^2, X) = \E(X^3) - \E(X^2)\E(X)
\]</span></p>
<p>The standard Gaussian has odd moments equal to zero so</p>
<p><span class="math display">\[
\Cov(X^2, X) = 0 - \E(X^2).0 = 0.
\]</span></p>
<p>If you don’t have the knowledge at your fingertips, there’s always direct calculation:</p>
<p>We already know that <span class="math inline">\(\E(X) = 0\)</span> for the standard Gaussian (it has mean <span class="math inline">\(0\)</span>).</p>
<p>Using integration by parts: <span class="math display">\[
\begin{align}
\E(X^3) &amp; = \frac{1}{\sqrt{2 \pi}}\int_{-\infty}^{\infty} x^3 e^{-x^2/2} dx \\
&amp;=  \frac{1}{\sqrt{2 \pi}}\int_{-\infty}^{\infty} x^2 \frac{d}{dx}(-e^{-x^2/2}) dx \\
&amp;= \frac{1}{\sqrt{2 \pi}} (-x^2 e^{-x^2/2} \rvert_{-\infty}^{\infty} + \int_{-\infty}^{\infty} 2 x e^{-x^2/2} dx) \\
&amp; = 2 \E(X) = 0.
\end{align}
\]</span></p>
</section>
<section id="sum-of-exponentials-is-gamma" class="level2">
<h2 class="anchored" data-anchor-id="sum-of-exponentials-is-gamma">2.2 Sum of Exponentials is Gamma</h2>
<p>The sum of <span class="math inline">\(n\)</span> IID random variables with exponential distribution with parameter <span class="math inline">\(\lambda\)</span> is gamma with pdf</p>
<p><span id="eq-gamma-pdf"><span class="math display">\[
\begin{align}
f(x) = \frac{\lambda^n}{(n-1)!}x^{n-1} e^{-\lambda x} &amp;, x \geq 0.
\end{align}
\tag{1}\]</span></span></p>
<p>Proof:</p>
<p>The pdf of the sum of two IID random variables is the convolution of the pdfs of the summands.</p>
<p>Therefore, <span class="math display">\[
\begin{align}
f(x) &amp;= \int_{0}^{x} \lambda^2 e^{-\lambda(x - y)}e^{-\lambda y} dy \\
&amp;= \lambda^2 e^{-\lambda x} \int_{0}^{x} dy \\
&amp;= \lambda^2 x e^{-\lambda x}.
\end{align}
\]</span></p>
<p>So, it’s at least plausible.</p>
<p>To prove the result, we use the MGF of the exponential random variables <span class="math inline">\(X\)</span> with parameter <span class="math inline">\(\lambda\)</span>:</p>
<p><span class="math display">\[
\begin{align}
\E(e^{tX}) &amp;= \frac{\lambda}{\lambda -t} &amp;, t &lt; \lambda.
\end{align}
\]</span></p>
<p>Let <span class="math inline">\(X_i\)</span> be a collection of IID exponential random variables with parameter <span class="math inline">\(\lambda\)</span>. Then <span class="math inline">\(Z = \sum X_i\)</span> satisfies</p>
<p><span class="math display">\[
\E(e^{tZ}) = \prod_{i=1}^n \E(e^{tX_i}) = \frac{\lambda^n}{(\lambda -t)^n}.
\]</span></p>
<p>Suppose that <span class="math inline">\(Y\)</span> has pdf (<a href="#eq-gamma-pdf">Equation&nbsp;1</a>), then for <span class="math inline">\(t &lt; \lambda\)</span> we see that be repeated integration by parts</p>
<p><span class="math display">\[
\begin{align}
\E(e^{tY}) &amp;= \int_0^{\infty} e^{tx} \frac{\lambda^n}{(n-1)!}x^{n-1} e^{-\lambda x} dx \\
&amp;=    \int_0^{\infty} \frac{\lambda^n}{(n-1)!}x^{n-1} e^{(t -\lambda) x} dx \\
&amp;= \int_0^{\infty} \frac{\lambda^n}{(n-1)!} x^{n-1} \frac{(-1)^n}{(\lambda -t)^n} \frac{d^n}{dx^n}e^{(t-\lambda)x} dx \\
&amp;= \frac{\lambda^n}{(n-1)!} \frac{(-1)^n}{(\lambda -t)^n} \int_0^{\infty} x^{n-1} \frac{d^n}{dx^n}e^{(t-\lambda)x} dx \\
&amp;= \frac{\lambda^n}{(n-1)!} \frac{(-1)^n}{(\lambda -t)^n} (-(n-1)\int_0^{\infty} x^{n-2} \frac{d^{n-1}}{dx^{n-1}}e^{(t-\lambda)x} dx) \\
&amp;= \frac{\lambda^n}{(\lambda - t)^n} \frac{(-1)^n}{(n-1)!}(-1)^{n-1} (n-1)!(e^{(t-\lambda)x}\rvert_0^{\infty}) \\
&amp;= \frac{\lambda^n}{(\lambda - t)^n} (-1)^{2n-1} (-1) \\
&amp;= \frac{\lambda^n}{(\lambda -t)^n}.
\end{align}
\]</span></p>
<p>The MGF characterises the distribution of the random variable so the proof is complete.</p>
</section>
<section id="why-sqrt2-pi" class="level2">
<h2 class="anchored" data-anchor-id="why-sqrt2-pi">2.3 Why <span class="math inline">\(\sqrt{2 \pi}\)</span>?</h2>
<p>Using polar coordinates</p>
<p><span class="math display">\[
\begin{align}
\int_{-\infty}^{\infty}\int_{-\infty}^{\infty} e^{-x^2 - y^2} dx dy &amp;= \int_0^{2 \pi} \int_0^{\infty} r e^{-r^2} dr d\theta \\
&amp;=  2 \pi \int_0^{\infty} r e^{-r^2} dr \\
&amp;=  2 \pi \int_0^{\infty} \frac{-1}{2} \frac{d}{dr}(e^{-r^2}) dr \\
&amp;=  - \pi e^{-r^2} \rvert_0^{\infty} \\
&amp;= \pi.
\end{align}
\]</span></p>
<p>Now, <span class="math display">\[
(\int_{-\infty}^{\infty} e^{-x^2} dx)^2 =
\int_{-\infty}^{\infty}\int_{-\infty}^{\infty} e^{-x^2 - y^2} dx dy = \pi.
\]</span></p>
<p>Therefore <span class="math display">\[
\int_{-\infty}^{\infty} e^{-x^2} dx = \sqrt{\pi}.
\]</span></p>
<p>I think the author may have meant for us to show that</p>
<p><span class="math display">\[
\int_{-\infty}^{\infty} e^{-x^2/2} dx = \sqrt{2 \pi}
\]</span></p>
<p>which follows by a change of variables <span class="math inline">\(x = y/\sqrt{2}\)</span></p>
<p><span class="math display">\[
\begin{align}
\int_{-\infty}^{\infty} e^{-x^2} dx &amp;= \int_{-\infty}^{\infty} e^{-(y/\sqrt{2})^2} \frac{1}{\sqrt{2}} dy \\
&amp;= \frac{1}{\sqrt{2}} \int_{-\infty}^{\infty} e^{-y^2/2} dy = \sqrt{\pi}.
\end{align}
\]</span></p>
</section>
<section id="box-muller" class="level2">
<h2 class="anchored" data-anchor-id="box-muller">2.4 Box-Muller</h2>
<p>Let <span class="math inline">\(U_1 \sim U(0,1)\)</span> and <span class="math inline">\(U_2 \sim U(0,1)\)</span>. Define random variables</p>
<p><span class="math display">\[
Z_1 = \sqrt{-2 \log(U_1)} \cos(2 \pi U_2)
\]</span> and <span class="math display">\[
Z_2 = \sqrt{-2 \log(U_1)} \sin(2 \pi U_2).
\]</span></p>
<p>Show that <span class="math inline">\(Z_1\)</span> and <span class="math inline">\(Z_2\)</span> are independent standard Gaussians.</p>
<p>Change to polar coordinates.</p>
<p>Note that</p>
<p><span class="math display">\[
R = \sqrt{Z_1^2 + Z_2^2} = \sqrt{-2 \log(U_1)}
\]</span></p>
<p>and</p>
<p><span class="math display">\[
\tan(\Theta) = \frac{Z_2}{Z_1} = \tan(2 \pi U_2).
\]</span> so <span class="math display">\[
\Theta = 2 \pi U_2
\]</span>.</p>
<p>The random variable <span class="math inline">\(R\)</span> has CDF</p>
<p><span class="math display">\[
\begin{align}
F_R(r) &amp;= P(R \leq r) \\
&amp;= P(\sqrt{-2 \log(U_2)} \leq r) \\
&amp;= P(U_2 \geq e^{-r^2/2}) \\
&amp;= 1 - P(U_2 &lt; e^{-r^2/2})
&amp;= 1 - \begin{cases}
0 &amp; \text{if } e^{-r^2/2} &lt;0, \\
e^{-r^2/2} &amp; \text{for } 0 \leq e^{-r^2/2} &lt; 1, \\
1 &amp; \text{if } e^{-r^2/2} \geq 1
\end{cases} \\
&amp;= 1 - e^{-r^2/2}.
\end{align}
\]</span></p>
<p>Obviously, <span class="math inline">\(\Theta \sim U(0, 2 \pi)\)</span>. Therefore, <span class="math inline">\((Z_1, Z_2)\)</span> has the same distribution as <span class="math inline">\((X, Y)\)</span> where <span class="math inline">\(X, Y\)</span> are IID standard Gaussians.</p>
</section>
<section id="marginally-gaussian-but-not-jointly-gaussian." class="level2">
<h2 class="anchored" data-anchor-id="marginally-gaussian-but-not-jointly-gaussian.">2.5 Marginally Gaussian but not Jointly Gaussian.</h2>
<p>Let <span class="math inline">\(X\)</span> be a standard Gaussian and define</p>
<p><span class="math display">\[
Y = \begin{cases}
X &amp; \text{if } |X| \leq 1, \\
-X &amp; \text{otherwise.}
\end{cases}
\]</span></p>
<p><span class="math inline">\(Y\)</span> is also a standard Gaussian.</p>
<p>Proof:</p>
<p>Let</p>
<p><span class="math display">\[
g(x) = \begin{cases}
x &amp; \text{if } |x| \leq 1, \\
-x &amp; \text{otherwise.}
\end{cases}
\]</span></p>
<p>Then the MGF of <span class="math inline">\(Y\)</span> can be expressed (using LOTUS) as</p>
<p><span class="math display">\[
\begin{align}
\sqrt{2 \pi} \E(e^{tY}) &amp;= \sqrt{2 \pi} \E(e^{tg(X)}) \\
&amp;= \int_{-\infty}^{\infty} e^{tg(x)} e^{-x^2/2} dx \\
&amp;= \int_{-1}^{1} e^{t x} e^{-x^2/2} dx + (\int_{-\infty}^{-1} + \int_1^{\infty}) e^{-t x} e^{-x^2/2} dx \\
&amp;= \int_{-1}^{1} e^{t x} e^{-x^2/2} dx + (\int_{\infty}^{1} + \int_{-1}^{-\infty}) - e^{t x} e^{-x^2/2} dx \\
&amp;= \int_{-1}^{1} e^{t x} e^{-x^2/2} dx + (\int_{1}^{\infty} + \int_{-\infty}^{-1} e^{t x} e^{-x^2/2} dx \\
&amp;= \int_{-\infty}^{\infty} e^{tx} e^{-x^2/2} dx \\
&amp;= \sqrt{2 \pi} \E(e^{tX}).
\end{align}
\]</span></p>
<p>Therefore, <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> are identically distributed. They are definitely not independent as <span class="math inline">\(Y\)</span> is a function of <span class="math inline">\(X\)</span> and so we have no right to expect that <span class="math inline">\(X + Y\)</span> is also Gaussian.</p>
<p>To see that <span class="math inline">\(X +Y\)</span> is not Gaussian, note that its range is in <span class="math inline">\([-2,2]\)</span>; there are lower bounds on Gaussian tails which are non-zero.</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>rg <span class="op">=</span> np.random.default_rng()</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>N <span class="op">=</span> <span class="dv">10000</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>bins <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> rg.normal(<span class="dv">0</span>,<span class="dv">1</span>, N)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> [x <span class="cf">if</span> np.<span class="bu">abs</span>(x) <span class="op">&lt;=</span><span class="dv">1</span> <span class="cf">else</span> <span class="op">-</span>x <span class="cf">for</span> x <span class="kw">in</span> X]</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>plt.hist(X<span class="op">+</span>Y, bins<span class="op">=</span>bins, label<span class="op">=</span><span class="st">'X + Y'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>plt.hist(X, bins, label<span class="op">=</span><span class="st">'X'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>plt.hist(Y, bins, label<span class="op">=</span><span class="st">'Y'</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>plt.legend(loc<span class="op">=</span><span class="st">'upper right'</span>)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>plt.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>[]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch2_exercises_files/figure-html/cell-2-output-2.png" width="583" height="411"></p>
</div>
</div>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data<span class="op">=</span>[X<span class="op">+</span>Y, X, Y]</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> plt.subplot()</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>ax.violinplot(data, <span class="bu">range</span>(<span class="bu">len</span>(data)), vert<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>ax.set_yticks(<span class="bu">range</span>(<span class="bu">len</span>(data)))</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>ax.set_yticklabels([<span class="st">'X+Y'</span>, <span class="st">'X'</span>, <span class="st">'Y'</span>])</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>plt.plot()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<pre><code>[]</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="ch2_exercises_files/figure-html/cell-3-output-2.png" width="578" height="411"></p>
</div>
</div>
</section>
<section id="pdf-of-brownian-bridge" class="level2">
<h2 class="anchored" data-anchor-id="pdf-of-brownian-bridge">2.6 PDF of Brownian Bridge</h2>
<p>Let <span class="math inline">\((M_t, t \in [0,1])\)</span> be a Brownian bridge.</p>
<ol type="a">
<li>write down the PDF of <span class="math inline">\((M_{1/4}, M_{3/4})\)</span></li>
</ol>
<p>The covariance matrix is</p>
<div class="cell" data-execution_count="3">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sympy.abc <span class="im">import</span> s,t</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cov(s, t):</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sp.Min(s,t) <span class="op">-</span>s <span class="op">*</span> t</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> sp.Rational(<span class="dv">1</span>, <span class="dv">4</span>), sp.Rational(<span class="dv">3</span><span class="op">/</span><span class="dv">4</span>)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> sp.Matrix([[cov(a, a), cov(a, b)],[cov(b, a), cov(b, b)]])<span class="op">;</span> C</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="3">
<p><span class="math inline">\(\displaystyle \left[\begin{matrix}\frac{3}{16} &amp; \frac{1}{16}\\\frac{1}{16} &amp; \frac{3}{16}\end{matrix}\right]\)</span></p>
</div>
</div>
<p>Using sympy, we can get the PDF easily:</p>
<div class="cell" data-execution_count="4">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fractions <span class="im">import</span> Fraction</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sympy.abc <span class="im">import</span> x,y</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>sp.init_printing()</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>Cinv <span class="op">=</span> C.inv()</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>xy <span class="op">=</span> sp.Matrix([x, y])</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> sp.exp(Fraction(<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>) <span class="op">*</span> sp.MatMul(xy.transpose(), Cinv, xy))<span class="op">/</span>(<span class="dv">2</span> <span class="op">*</span>sp.pi <span class="op">*</span> sp.sqrt(C.det(), evaluate<span class="op">=</span><span class="va">False</span>))</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>pdf <span class="op">=</span> f[<span class="dv">0</span>]</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>pdf</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpe7t7yklr/texput.png'</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="4">
<p><span class="math inline">\(\displaystyle \frac{2 \sqrt{2} e^{- 3 x^{2} + 2 x y - 3 y^{2}}}{\pi}\)</span></p>
</div>
</div>
<ol start="2" type="a">
<li>write down the probability of the event <span class="math inline">\({M_{1/4}^2 + M_{3/4}^2 \leq 1}\)</span> as a double integral</li>
</ol>
<div class="cell" data-execution_count="5">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> sp.symbols(<span class="st">'r'</span>, nonegative<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>theta <span class="op">=</span> sp.symbols(<span class="st">'theta'</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>pdf <span class="op">=</span> pdf.subs({x: r<span class="op">*</span>sp.cos(theta), y: r<span class="op">*</span>sp.sin(theta)}).simplify()</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>prob <span class="op">=</span> sp.Integral(pdf <span class="op">*</span> r, (r, <span class="dv">0</span>, <span class="dv">1</span>), (theta, <span class="dv">0</span>, <span class="dv">2</span> <span class="op">*</span>sp.pi))<span class="op">;</span> prob</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmp8r0i8p41/texput.png'</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="5">
<p><span class="math inline">\(\displaystyle \int\limits_{0}^{2 \pi}\int\limits_{0}^{1} \frac{2 \sqrt{2} r e^{r^{2} \left(\sin{\left(2 \theta \right)} - 3\right)}}{\pi}\, dr\, d\theta\)</span></p>
</div>
</div>
<p>The integral can be calculated numerically using Simpson’s rule or a Monte Carlo simulation:</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> simps</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> evaluate_integral(integrand):</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1000</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    theta <span class="op">=</span> np.linspace(<span class="dv">0</span>, <span class="dv">2</span><span class="op">*</span> np.pi, <span class="dv">1000</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    zz <span class="op">=</span> integrand(r.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), theta.reshape(<span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>))</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> simps([simps(zz_r, r) <span class="cf">for</span> zz_r <span class="kw">in</span> zz], theta)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> monte_carlo(integrand):</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    samples <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">sum</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(samples):</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>        u <span class="op">=</span> np.random.default_rng().uniform(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>        r, theta <span class="op">=</span> u[<span class="dv">0</span>], <span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>u[<span class="dv">1</span>]</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span> <span class="op">+=</span>integrand(r, theta)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">2</span><span class="op">*</span>np.pi <span class="op">*</span> <span class="bu">sum</span><span class="op">/</span>samples</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>numerical_soln <span class="op">=</span> evaluate_integral(sp.lambdify([r, theta], pdf <span class="op">*</span>r))<span class="op">;</span> <span class="bu">print</span>(numerical_soln)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>monte_carlo(sp.lambdify([r, theta], pdf<span class="op">*</span>r))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.926901699267537</code></pre>
</div>
<div class="cell-output cell-output-error">
<pre><code>FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpm835xaue/texput.png'</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="6">
<p><span class="math inline">\(\displaystyle 0.937331636922149\)</span></p>
</div>
</div>
<p>Alternatively, we can approximate the desired probability by using the Cholesky decomposition:</p>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simulate(samples):</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    rg <span class="op">=</span> np.random.default_rng()</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    C <span class="op">=</span> [[<span class="dv">3</span><span class="op">/</span><span class="dv">16</span>, <span class="dv">1</span><span class="op">/</span><span class="dv">16</span>], [<span class="dv">1</span><span class="op">/</span><span class="dv">16</span>, <span class="dv">3</span><span class="op">/</span><span class="dv">16</span>]]</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> np.linalg.cholesky(C)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    samples <span class="op">=</span> <span class="dv">1000</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    in_disk <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(samples):</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>        sample <span class="op">=</span> A.dot(rg.normal(<span class="dv">0</span>,<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> sample[<span class="dv">0</span>]<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> sample[<span class="dv">1</span>]<span class="op">**</span><span class="dv">2</span> <span class="op">&lt;=</span> <span class="dv">1</span>:</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>            in_disk <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> in_disk<span class="op">/</span>samples</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>simulated_result <span class="op">=</span> simulate(<span class="dv">1000</span>)<span class="op">;</span> simulated_result</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpjj15jhd4/texput.png'</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="7">
<p><span class="math inline">\(\displaystyle 0.938\)</span></p>
</div>
</div>
<p>The two approaches differ by</p>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="bu">abs</span>(simulated_result <span class="op">-</span> numerical_soln)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpy8l_72wc/texput.png'</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="8">
<p><span class="math inline">\(\displaystyle 0.011098300732463\)</span></p>
</div>
</div>
</section>
<section id="the-covariance-of-a-random-vector-is-always-positive-semidefinite" class="level2">
<h2 class="anchored" data-anchor-id="the-covariance-of-a-random-vector-is-always-positive-semidefinite">2.7 The Covariance of a Random Vector is Always Positive Semidefinite</h2>
<p>Let <span class="math inline">\(\mathcal{C}\)</span> be the covariance matrix of a random vector <span class="math inline">\(X = (X_i)\)</span>.</p>
<p>We must demonstrate that</p>
<p><span id="eq-covariance-pos-semidef"><span class="math display">\[
\sum_{i,j} a_i a_j \mathcal{C}_{ij} \geq 0
\tag{2}\]</span></span> for any <span class="math inline">\(a \in \mathbb{R}^n\)</span>.</p>
<p>Define <span class="math display">\[
Y = \sum_{i=1}^n a_i X_i
\]</span></p>
<p>and calculate the variance of <span class="math inline">\(Y\)</span> showing that it is equal to the left-hand side of (<a href="#eq-covariance-pos-semidef">Equation&nbsp;2</a>):</p>
<p><span class="math display">\[
\begin{align}
\Var(Y) &amp;= \E(Y^2) - \E(Y)^2 \\
      &amp;= \E(\sum_{i,j=1} a_i a_j X_i X_j ) - \sum_{i,j=1}^n a_i a_j \E(X_i)\E(X_j) \\
      &amp;= \sum_{i,j=1}^n a_i a_j (\E(X_i X_j) - \E(X_i) \E(X_j)) \\
      &amp;=  \sum_{i,j=1}^n a_i a_j \mathcal{C}_{ij}.
\end{align}
\]</span></p>
<p>The proof is complete by noting that <span class="math inline">\(\Var(Y) \geq 0\)</span>.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The variance of a random variable is invariant under translation i.e.</p>
<p>if <span class="math inline">\(X\)</span> is a random variable and <span class="math inline">\(c \in \mathbb{R}\)</span>, then</p>
<p><span class="math display">\[
\Var(X + c) = \Var(X).
\]</span> This follows by a simple book-keeping exercise: <span class="math display">\[
\begin{align}
\Var(X+c) &amp;= \E(X^2 + 2cX + c^2) - (\E(X) + c)^2\\
&amp;= \E(X^2) +2c\E(x) +c^2 - \E(X)^2  - 2x \E(X) - c^2 \\
&amp;= \E(X^2) - \E(X)^2 \\
&amp;= \Var(X).
\end{align}
\]</span></p>
<p>It is clear that <span class="math inline">\(\Var(X) \geq 0\)</span> when <span class="math inline">\(X\)</span> has mean zero:</p>
<p><span class="math display">\[
\Var(X) = \E(X^2) = \int_{-\infty}^{\infty} x^2 dF(x) \geq 0.
\]</span></p>
<p>If <span class="math inline">\(m\)</span> is the mean of <span class="math inline">\(X\)</span>, then <span class="math inline">\(X -m\)</span> has mean zero and so using invariance of the variance:</p>
<p><span class="math display">\[
\Var(X) = \Var(X - m) \geq 0.
\]</span></p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><span class="math inline">\(X\)</span> is a constant with probability 1 <span class="math inline">\(\iff \Var(X) = 0\)</span>.</p>
<p>Proof:</p>
<p>If <span class="math inline">\(X = c\)</span>, then <span class="math display">\[
\Var(X) = \E(c^2) - \E(c)^2 = c^2 - c^2 = 0.
\]</span></p>
<p>If <span class="math inline">\(\Var(X) = 0\)</span>, then <span class="math inline">\(\Var(X - \E(X)) = 0\)</span>, by translation invariance of <span class="math inline">\(\Var\)</span>. Let <span class="math inline">\(Y = X - \E(X)\)</span>. Then</p>
<p><span class="math display">\[
\Var(Y) = \int_{-\infty}^{\infty} y^2 dF_Y(y)
\]</span> and so <span class="math display">\[
F_Y(y) = \begin{cases}
0 &amp; \text{for } y &lt; 0, \\
1 &amp; \text{otherwise}.
\end{cases}
\]</span> Therefore, <span class="math inline">\(Y = 0\)</span> with probability 1 and so <span class="math inline">\(X = \E(X)\)</span> with probability 1 i.e.&nbsp;<span class="math inline">\(X\)</span> is a constant.</p>
</div>
</div>
<p>Since the LHS of (<a href="#eq-covariance-pos-semidef">Equation&nbsp;2</a>) is the variance of <span class="math inline">\(\sum_i a_i X_i\)</span>, we see that <span class="math inline">\(\mathcal{C}\)</span> is positive <em>definite</em> if and only if the variance of <span class="math inline">\(\sum_i a_i X_i\)</span> is non-zero for all non-zero <span class="math inline">\(a\)</span>.</p>
<p>The covariance matrix of a random vector <span class="math inline">\(X = (X_i)\)</span> is positive-definite if and only if each linear combination of the coordinates is non-constant.</p>
<p>When <span class="math inline">\(X_i\)</span> are jointly Gaussian, then each linear combination is a Gaussian random variable: the only constant a linear combination of Gaussian variables can sum to is zero.</p>
<p>Therefore, for jointly Gaussian random variables, the covariance matrix is positive-definite if and only if the the variables are linearly independent. See <a href="#sec-degenerate-is-li">Section&nbsp;12</a>.</p>
</section>
<section id="a-linear-transformation-of-gaussian-vector-is-also-gaussian" class="level2">
<h2 class="anchored" data-anchor-id="a-linear-transformation-of-gaussian-vector-is-also-gaussian">2.8 A Linear Transformation of Gaussian Vector is Also Gaussian</h2>
<p>Let <span class="math inline">\(X = (X_i)_{i=1}^n\)</span> be a Gaussian vector an <span class="math inline">\(M\)</span> be an <span class="math inline">\(m \times n\)</span> matrix.</p>
<p><span class="math inline">\(Y = MX\)</span> is also Gaussian.</p>
<p>Proof:</p>
<p>We can write</p>
<p><span class="math display">\[
\begin{align}
Y &amp;= (\sum_{i=1}^n M_{ij} X_i)_{j=1}^m
\end{align}
\]</span> and so express <span class="math inline">\(Y\)</span> as a vector of linear combinations of <span class="math inline">\(X_i\)</span> making its components Gaussian. Moreover, we can express any linear combination of components of <span class="math inline">\(MX\)</span> as a linear combination of <span class="math inline">\(X_i\)</span>:</p>
<p><span class="math display">\[
\begin{align}
\sum_{j=1}^m a_j Y_j &amp;= \sum_{j=1}^m a_j (\sum_{i=1}^n M_{ji} X_i) \\
&amp;= \sum_{i,j} a_j M_{ji} X_i \\
&amp;= \sum_{i} b_i X_i
\end{align}
\]</span> where <span class="math display">\[
b_i = \sum_j a_j M_{ji}.
\]</span> Written in a more suggestive manner: <span class="math display">\[
a^T MX = (M^T a)^T X.
\]</span> <span class="math inline">\(\square\)</span></p>
<p>Let <span class="math inline">\(\mathcal{C}\)</span> be the covariance matrix of <span class="math inline">\(X\)</span>.</p>
<p>We can express the covariance matrix of <span class="math inline">\(Y\)</span> in terms of <span class="math inline">\(M\)</span> and <span class="math inline">\(\mathcal{C}\)</span>:</p>
<p><span class="math display">\[
\begin{align}
\Cov(Y_i, Y_j) &amp;= \E(Y_i Y_j) - \E(Y_i) \E(Y_j) \\
&amp;= \E( \sum_\alpha M_{i \alpha} X_\alpha \sum_\beta M_{j \beta} X_\beta ) - \sum_\alpha M_{i \alpha} \E(Y_i) \sum_\beta M_{j \beta } \E(Y_j) \\
&amp;= \sum_\alpha \sum_\beta M_{i\alpha }M_{j \beta} (\E(X_\alpha X_\beta) - \E(X_\alpha) \E(X_\beta)) \\
&amp;= \sum_\alpha \sum_\beta M_{i \alpha}\mathcal{C}_{\alpha \beta} M^T_{\beta j}. \\
\end{align}
\]</span></p>
<p>In shorter notation:</p>
<p><span class="math display">\[
\Cov(Y) = M \mathcal{C}M^T.
\]</span></p>
<p>Suppose that <span class="math inline">\(m =n\)</span>. Then,</p>
<p><span class="math display">\[
\begin{align}
\det(\Cov(Y)) &amp;= \det(M)\det(\mathcal{C})\det(M^T) \\
&amp;= \det(M)^2\det(\mathcal{C}).
\end{align}
\]</span> If follows that <span class="math inline">\(Y\)</span> is non-degenerate (<span class="math inline">\(\det(\Cov(Y)) \neq 0\)</span>) <span class="math inline">\(\iff\)</span> <span class="math inline">\(\det(M) \neq 0\)</span>.</p>
<p>For general <span class="math inline">\(M\)</span>, it is necessary that <span class="math inline">\(m \leq n\)</span> and <span class="math inline">\(M\)</span> is full-rank <span class="math inline">\(m\)</span> for <span class="math inline">\(\Cov(Y)\)</span> to be positive definite.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The domain of <span class="math inline">\(M^T\)</span> is <span class="math inline">\(m\)</span>-dimensional. The range of <span class="math inline">\(M^T\)</span>, <span class="math inline">\(\mathcal{R}(M^T)\)</span>, has dimension <span class="math inline">\(\rank(M^T\)</span>). Since <span class="math inline">\(\mathcal{C}\)</span> is invertible, <span class="math inline">\(\mathcal{C}(\mathcal{R}(M^T))\)</span> has dimension <span class="math inline">\(\rank(M^T)\)</span>. Finally, <span class="math inline">\(\dim(M(\mathcal{C}(\mathcal{R}(M^T)))) = \rank(M)\)</span> by virtue of <span class="math inline">\(\rank(M^T) = \rank(M)\)</span>. That is, <span class="math inline">\(\rank(\Cov(Y)) = \rank(M)\)</span>.</p>
<p>For <span class="math inline">\(\Cov(Y)\)</span> to be invertible (making <span class="math inline">\(\Cov(Y)\)</span> positive <em>definite</em>), we require <span class="math inline">\(\rank(M) = m\)</span> i.e <span class="math inline">\(M\)</span> must be full-rank. Given that <span class="math inline">\(\rank(M) \leq \min(m, n)\)</span>, when <span class="math inline">\(M\)</span> is full-rank <span class="math inline">\(m \leq n\)</span>.</p>
</div>
</div>
</section>
<section id="iid-decomposition" class="level2">
<h2 class="anchored" data-anchor-id="iid-decomposition">2.9 IID Decomposition</h2>
<p>Let <span class="math inline">\((X, Y)\)</span> be a Gaussian vector with mean <span class="math inline">\(0\)</span> and covariance matrix <span class="math display">\[
\mathcal{C} = \begin{bmatrix}
1 &amp; \rho \\
\rho &amp; 1
\end{bmatrix},
\]</span> for <span class="math inline">\(\rho \in (-1, 1)\)</span>.</p>
<p>Take <span class="math inline">\(Z_1 = X\)</span>. <span class="math inline">\(Z_1\)</span> is a standard Gaussian: it has mean <span class="math inline">\(0\)</span> by assumption and the covariance matrix tells us that <span class="math inline">\(\Var(X_1) = 1\)</span>.</p>
<p>We perform Gram-Schmidt to express <span class="math inline">\((X, Y)\)</span> as a linear combination of IID standard Gaussians. Start with <span class="math display">\[
\begin{align}
Z^{'}_2 &amp;= Y - \E(YZ_1)Z_1 \\
&amp;= Y - \rho Z_1.
\end{align}
\]</span></p>
<p>By linearity of expectation, <span class="math display">\[
\begin{align}
\Var(Z^{'}_2) &amp;= \E((Y - \rho Z_1)^2) \\
&amp;= \E(Y^2) - 2\rho \E(Y Z_1) + \rho^2 \E(Z_1^2) \\
&amp;= 1 -  \rho^2.
\end{align}
\]</span> We set <span class="math display">\[
Z_2 = \frac{1}{\sqrt{1 - \rho^2}} Z_2^{'}
\]</span> and so <span class="math inline">\(Z_2\)</span> has variance 1: <span class="math inline">\(Z_1\)</span> is a standard Gaussian.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
<span class="math inline">\(Z_1\)</span> and <span class="math inline">\(Z_2\)</span> are independent
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For Gaussians, it is sufficient to demonstrate that <span class="math display">\[
\E(Z_1 Z_2) = 0.
\]</span> We expect this from the Gram-Schmidt process but it doesn’t hurt to check:</p>
<p><span class="math display">\[
\begin{align}
\E(Z_1Z_2) &amp; = \frac{1}{\sqrt{1 - \rho^2}}\E(X(Y - \rho X)) \\
&amp;= \frac{\E(XY) - \rho\E(X^2)}{\sqrt{1 -\rho^2}} \\
&amp;= 0.
\end{align}
\]</span></p>
</div>
</div>
</div>
<p>We can write <span class="math display">\[
(X, Y) = (Z_1, \rho Z_1 + \sqrt{1 - \rho^2} Z_2)
\]</span> to express <span class="math inline">\((X, Y)\)</span> as a linear combination of IID standard Gaussians.</p>
<p>The PDF of <span class="math inline">\((X, Y)\)</span> is given by</p>
<div class="cell" data-execution_count="9">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sympy.abc <span class="im">import</span> x, y, rho</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fractions <span class="im">import</span> Fraction</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>sp.init_printing()</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> sp.Matrix([[<span class="dv">1</span>, rho], [rho, <span class="dv">1</span>]])</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>Cinv <span class="op">=</span> C.inv()</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>factor <span class="op">=</span> sp.gcd(<span class="bu">tuple</span>(Cinv))</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>xy <span class="op">=</span> sp.Matrix([x, y])</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> sp.exp(Fraction(<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>) <span class="op">*</span> sp.MatMul(xy.transpose(), Cinv, xy))<span class="op">/</span>(<span class="dv">2</span> <span class="op">*</span>sp.pi <span class="op">*</span> sp.sqrt(C.det()))<span class="op">;</span> f[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmpy8f5qzaw/texput.png'</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="9">
<p><span class="math inline">\(\displaystyle \frac{e^{\frac{- 2 \rho x y + x^{2} + y^{2}}{2 \left(\rho - 1\right) \left(\rho + 1\right)}}}{2 \pi \sqrt{1 - \rho^{2}}}\)</span></p>
</div>
</div>
</section>
<section id="iid-decomposition-1" class="level2">
<h2 class="anchored" data-anchor-id="iid-decomposition-1">2.10 IID Decomposition</h2>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> sp.Matrix([[<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>], [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>]])</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> C.cholesky()</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>Ainv <span class="op">=</span> A.inv()</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>z1, z2, z3, x1, x2, x3 <span class="op">=</span> sp.symbols(<span class="st">'z_1 z_2 z_3 x_1 x_2 x_3'</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Matrix([x1, x2, x3])</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> sp.MatMul(Ainv, x, evaluate<span class="op">=</span><span class="va">True</span>)<span class="op">;</span> z</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmp9i4_qyi1/texput.png'</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="10">
<p><span class="math inline">\(\displaystyle \left[\begin{matrix}\frac{\sqrt{2} x_{1}}{2}\\- \frac{\sqrt{6} x_{1}}{6} + \frac{\sqrt{6} x_{2}}{3}\\- \frac{\sqrt{3} x_{1}}{6} - \frac{\sqrt{3} x_{2}}{6} + \frac{\sqrt{3} x_{3}}{2}\end{matrix}\right]\)</span></p>
</div>
</div>
</section>
<section id="iid-decomposition-2" class="level2">
<h2 class="anchored" data-anchor-id="iid-decomposition-2">2.11 IID Decomposition</h2>
<p><span class="math display">\[
\mathcal{C}= \begin{bmatrix}
3 &amp; 1 &amp; 1 \\
1 &amp; 3 &amp; -1 \\
1 &amp; -1 &amp; 3
\end{bmatrix}
\]</span></p>
<p><span class="math inline">\(\det{\mathcal{C}}\)</span> is</p>
<div class="cell" data-execution_count="11">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>C <span class="op">=</span> [[<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>,<span class="dv">3</span>,<span class="op">-</span><span class="dv">1</span>], [<span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">3</span>]]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>np.linalg.det(C)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>FileNotFoundError: [Errno 2] No such file or directory: '/tmp/tmp2_afo7x0/texput.png'</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="11">
<p><span class="math inline">\(\displaystyle 16.0\)</span></p>
</div>
</div>
<p>and so <span class="math inline">\(X\)</span> is non-degenerate.</p>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Sim211:</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    C <span class="op">=</span> [[<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>], [<span class="dv">1</span>,<span class="dv">3</span>,<span class="op">-</span><span class="dv">1</span>], [<span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">3</span>]]</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.__A <span class="op">=</span> np.linalg.cholesky(C)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> path(<span class="va">self</span>, rg <span class="op">=</span> np.random.default_rng()):</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.__A.dot(rg.normal(<span class="dv">0</span>, <span class="dv">1</span>, <span class="bu">len</span>(C[<span class="dv">0</span>])))</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>sim <span class="op">=</span> Sim211()</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">100</span>):</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    plt.plot(<span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">4</span>), sim.path())</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="ch2_exercises_files/figure-html/cell-13-output-1.png" width="569" height="411"></p>
</div>
</div>
</section>
<section id="sec-degenerate-is-li" class="level2">
<h2 class="anchored" data-anchor-id="sec-degenerate-is-li">2.12 Degenerate Means Linearly Independent</h2>
<p>Let <span class="math inline">\(X = (X_i)_{i=1}^n\)</span> be a Gaussian vector with covariance <span class="math inline">\(\mathcal{C}\)</span>.</p>
<p><span class="math inline">\(\det{\mathcal{C}} = 0 \iff\)</span> there exists <span class="math inline">\(c \in \mathbb{R}^n\setminus{0}\)</span> such that</p>
<p><span class="math display">\[
\sum_i c_i X_i = 0.
\]</span></p>
<p>Proof:</p>
<p>By definition, <span class="math inline">\(X\)</span> is a degenerate Gaussian vector iff <span class="math inline">\(\det{\mathcal{C}} = 0\)</span>. Since <span class="math inline">\(\mathcal{C}\)</span> is symmetric semi-positive definite, <span class="math inline">\(\det{\mathcal{C}} = 0\)</span> iff there exists <span class="math inline">\(c \in \mathbb{R}^n\setminus{0}\)</span> such that</p>
<p><span class="math display">\[
c^T \mathcal{C} c = 0.
\]</span></p>
<p>This can be written as a statement about the variance of a Gaussian random variable:</p>
<p><span class="math display">\[
c^T \mathcal{C} c = \Var(\sum_i c_i X_i) = 0.
\]</span></p>
<p>A random variable with variance 0 is a constant; the only constant a Gaussian variable can equal is 0.</p>
<p>Therefore,</p>
<p><span class="math display">\[
c^T C c = 0 \iff \sum_i c_i X_i = 0.
\]</span> <span class="math inline">\(\square\)</span></p>
<p>The textbook hints that we should use <span class="math inline">\(\mathcal{C} = AA^T\)</span> but I think this needs some care to avoid circularity if we’re using this to fill in proofs in the text. Obviously, we can’t use results where the existence of <span class="math inline">\(A\)</span> is predicated on <span class="math inline">\(X\)</span> being non-degenerate!</p>
<p>The approach I take here is to prove the equivalent theorem</p>
<p><span class="math inline">\(\det{\mathcal{C}} \neq 0 \iff X_i\)</span> are linearly independent.</p>
<p>Proof:</p>
<p>Suppose that <span class="math inline">\(X\)</span> has mean zero without loss of generality.</p>
<p>Suppose <span class="math inline">\((X_i)\)</span> are linearly independent and so form an <span class="math inline">\(n\)</span>-dimensional vector space <span class="math inline">\(V\)</span> with addition being the usual addition of random variables. The vector space is equipped with the inner product <span class="math inline">\(\E: V \times V \mapsto \mathbb{R}\)</span>. This allows us to can use the Gram-Schmidt process to create <span class="math inline">\(n\)</span> IID (orthogonal wrt <span class="math inline">\(\E\)</span>) Gaussian standard vectors <span class="math inline">\((Z_i)\)</span> with mean zero. The space <span class="math inline">\(V\)</span> is spanned by both <span class="math inline">\((X_i)\)</span> and <span class="math inline">\((Z_i)\)</span> and so they are related by an invertible change of coordinates <span class="math inline">\(A\)</span> such that <span class="math inline">\(X = AZ\)</span>. In addition,</p>
<p><span class="math display">\[
\mathcal{C} = AA^T
\]</span></p>
<p>since</p>
<p><span class="math display">\[
\mathcal{C}_{ij} = \E(X_i Xj) = \E(\sum_m A_{im} Z_m \sum_n A_{jn} Z_n) = (AA^T)_{ij}.
\]</span></p>
<p>Since <span class="math inline">\(A\)</span> is invertible, <span class="math inline">\(\det(A) = \det(A^T) \neq 0\)</span> and so</p>
<p><span class="math display">\[
\det(\mathcal{C} ) = \det(A)^2  &gt; 0.
\]</span></p>
<p>Now, suppose that <span class="math inline">\(\det{C} \neq 0\)</span>. Then <span class="math inline">\(X\)</span> is non-degenerate and so there exists an invertible matrix <span class="math inline">\(A\)</span> and <span class="math inline">\(n\)</span> IID standard Gaussian random variables such that <span class="math inline">\(X=AZ\)</span>. The variables <span class="math inline">\(Z_i\)</span> are linearly independent and we can leverage this and the invertibility of <span class="math inline">\(A^T\)</span>:</p>
<p><span class="math display">\[
\sum_i c_i X_i = \sum_i c_i A^T Z_i = A^T (\sum_i c_i Z_i)
\]</span> and so <span class="math inline">\(\sum_i c_i X_i = 0\)</span> iff <span class="math inline">\(\sum_i c_i Z_i = 0\)</span> which would be a contradiction if the <span class="math inline">\(c_i\)</span> are not all zero.</p>
<p>We have shown that</p>
<p><span class="math inline">\(\det{\mathcal{C}} \neq 0 \iff X_i\)</span> are linearly independent.</p>
<p>Equivalently, <span class="math display">\[
\det{\mathcal{C}} = 0 \iff \exists c \in \mathbb{R}^n\setminus{0} \text{ such that } \sum_i c_i X_i = 0.
\]</span></p>
<p><span class="math inline">\(\square\)</span></p>
</section>
<section id="iid-decomposition-for-degenerate-vectors" class="level2">
<h2 class="anchored" data-anchor-id="iid-decomposition-for-degenerate-vectors">2.13 IID Decomposition For Degenerate Vectors</h2>
<p>Let <span class="math inline">\(X = (X_i)_{i=1}^{n}\)</span> be a degenerate Gaussian vector with mean zero.</p>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>The question does not state that the mean of <span class="math inline">\(X\)</span> is zero: this appear to be an error.</p>
</div>
</div>
<p>The Gaussian variables <span class="math inline">\(X_i\)</span> form a finite-dimensional vector space <span class="math inline">\(V\)</span> under addition of random variables and multiplication by reals. The dimension of <span class="math inline">\(V\)</span> is less than <span class="math inline">\(n\)</span>, because the <span class="math inline">\(X_i\)</span> are linearly dependent.</p>
<p>The expectation operator is an inner-product on <span class="math inline">\(V\)</span> and we can use this inner-product to to form a basis <span class="math inline">\(Z = (Z_i)_{i=1}^m\)</span> <span class="math inline">\(m &lt; n\)</span> for <span class="math inline">\(V\)</span> of IID standard Gaussian variables. Each <span class="math inline">\(X_i\)</span> can be written in exactly one way as a linear combination of <span class="math inline">\(Z\)</span>:</p>
<p><span class="math display">\[
X_i = \sum_{j=1}^m a_{ij} Z_j.
\]</span> That is, there is an <span class="math inline">\(m \times n\)</span> matrix <span class="math inline">\(A\)</span> such that <span class="math display">\[
X = A Z.
\]</span></p>
<p>The elements of the covariance matrix of <span class="math inline">\(X\)</span> can be expressed in terms of <span class="math inline">\(A\)</span>:</p>
<p><span class="math display">\[
\begin{align}
\mathcal{C}_{ij} &amp;= \E(X_i X_j) \\
&amp;= \E(\sum_\alpha a_{i\alpha} Z_\alpha \sum_\beta a_{j \beta} Z_\beta) \\
&amp;= \sum_{\alpha, \beta} a_{i\alpha}a_{j\beta} \E(Z_\alpha Z_\beta) \\
&amp;= \sum_\alpha a_{i \alpha} a_{j \alpha} \\
&amp;= (A A^T)_{ij}.
\end{align}
\]</span></p>
</section>
<section id="brownian-bridge-from-brownian-motion" class="level2">
<h2 class="anchored" data-anchor-id="brownian-bridge-from-brownian-motion">2.14 Brownian Bridge From Brownian Motion</h2>
<p>Let <span class="math inline">\((B_t, t \in [0, 1])\)</span> be a Brownian motion.</p>
<ol type="a">
<li>Show that the process given by <span class="math inline">\((M_t = B_t - t B_1, t \in [0, 1])\)</span> is a Brownian bridge.</li>
</ol>
<p>Step 1: show that <span class="math inline">\(M_t\)</span> is a Gaussian process.</p>
<p>Choose <span class="math inline">\(0 = t_1 &lt; t_2 &lt; ... t_n =1\)</span>. The process <span class="math inline">\((M_{t_i})\)</span> is a linear transformation of <span class="math inline">\((B_{t_i})\)</span>:</p>
<p><span class="math display">\[
A_{ij} = \delta_{ij} - t \delta_{nj}
\]</span></p>
<p>e.g for a process with three time points</p>
<p><span class="math display">\[
A = \begin{bmatrix}
1 &amp; 0 &amp; -t \\
0 &amp; 1 &amp; -t \\
0 &amp; 0 &amp; 1-t
\end{bmatrix}.
\]</span></p>
<p>Step 2: Show that the mean of <span class="math inline">\((M_t)\)</span> is equal to zero</p>
<p><span class="math display">\[
\E(M_t) = \E(B_t - t B_1) = \E(B_t) - t\E(B_1) = 0.
\]</span></p>
<p>Step 3: Show that the <span class="math inline">\(\Cov(M_t, M_s) = \min(s,t) - st\)</span>.</p>
<p><span class="math display">\[
\begin{align}
\Cov(M_t, M_s) &amp;= \Cov(B_t -t B_1, B_s - t B_1) \\
&amp;= \E(B_t B_s - t B_t B_1 -t B_s B_1 + t^2 B_1^2) \\
&amp;= \E(B_t B_s) -t \E(B_t B_1) -t \E(B_s B_1) + t^2 \E(B_1^2) \\
&amp;= \min(s, t) - st.
\end{align}
\]</span></p>
<ol start="2" type="a">
<li>Show that the random variable <span class="math inline">\(B_t - t B_1\)</span> is independent of of <span class="math inline">\(B_1\)</span> for any <span class="math inline">\(t \in [0, 1]\)</span>.</li>
</ol>
<p>Consider the covariance:</p>
<p><span class="math display">\[
\begin{align}
\Cov(B_t - t B_1, B_1) &amp;= \E(B_tB_1 -t B_1 B_1) \\
&amp;= \E(B_tB_1) -t \E(B_1^2) \\
&amp;= t - t \\
&amp;= 0.
\end{align}
\]</span></p>
<p>Since <span class="math inline">\(B_t -t B_1\)</span> and <span class="math inline">\(B_1\)</span> are Gaussian variables, this is enough to establish independence.</p>
</section>
<section id="triangle-inequality" class="level2">
<h2 class="anchored" data-anchor-id="triangle-inequality">2.15 Triangle Inequality</h2>
<p>Let <span class="math inline">\(X, Y\)</span> be two random variables in <span class="math inline">\(L^2(\Sigma, \mathcal{F}, \P)\)</span>. Prove the triangle inequality</p>
<p><span class="math display">\[
\sqrt{\E((X+Y)^2)} \leq \sqrt{\E(X^2) + \E(Y^2)}.
\]</span></p>
<p>Expand the square and use Cauchy-Schwarz:</p>
<p><span class="math display">\[
\begin{align}
\E((X+Y)^2) &amp;= \E(X^2 + 2 X Y + Y^2) \\
&amp;= \E(X^2) + 2 \E(XY) + \E(Y^2) \\
&amp;\leq \E(X^2) + 2 \sqrt{\E(X^2) \E(Y^2)} + \E(Y^2) \\
&amp;= (\sqrt{\E(X^2)} + \sqrt{\E(Y^2)})^2.
\end{align}
\]</span></p>
<p>Let <span class="math inline">\(S_k = \sum_{i=1}^k X_i\)</span>. Suppose that the triangle inequality holds for <span class="math inline">\(S_k\)</span>:</p>
<p><span class="math display">\[
\sqrt{\E(S_k^2)} \leq \sum_{i=1}^k\sqrt{\E(X_i^2)}.
\]</span></p>
<p>Consider the next case <span class="math inline">\(S_{k+1}\)</span>:</p>
<p><span class="math display">\[
\sqrt{\E(S_{k+1}^2)}  = \sqrt{\E((X_{k+1} + S_k)^2)} \leq \sqrt{\E(X_{k+1}^2)} + \sqrt{\E(S_k^2)} = \sum_{i=1}^{k+1}\sqrt{\E(X_k^2)}
\]</span> using the two-term triangle inequality. The result follows by induction since the triangle inequality holds for <span class="math inline">\(k=2\)</span>.</p>
</section>
<section id="the-space-of-integrable-random-variables-is-l1" class="level2">
<h2 class="anchored" data-anchor-id="the-space-of-integrable-random-variables-is-l1">2.16 The Space of Integrable Random Variables is <span class="math inline">\(L^1\)</span></h2>
<p><span class="math inline">\(L^1(\Omega, \mathcal{F}, \P)\)</span> is a linear space.</p>
<p>Proof:</p>
<p>If <span class="math inline">\(X, Y \in L^1\)</span> and <span class="math inline">\(a, b \in \mathbb{R}\)</span>, then</p>
<p><span class="math display">\[
aX + bY
\]</span></p>
<p>is a random variable on the probability space and by the triangle inequality</p>
<p><span class="math display">\[
|aX + bY| \leq |a| |X| + |b| |Y|.
\]</span> The right-hand side is integrable so |aX + BY| is integrable. Therefore, <span class="math inline">\(aX + bY \in L^1\)</span>. The zero vector of <span class="math inline">\(L^1\)</span> is a random variable on the probability space which is zero with probability one.</p>
<p><span class="math inline">\(\square\)</span></p>
<p><span class="math inline">\(\| X \|_1 \triangleq \E(|X|)\)</span> is a norm for <span class="math inline">\(L^1\)</span>.</p>
<p>Proof:</p>
<p>To verify that <span class="math inline">\(\| \cdot \|_1\)</span> is a norm for <span class="math inline">\(L^1\)</span> we must verify that</p>
<ol type="1">
<li><span class="math inline">\(\| X + Y \|_1 \leq \| X\|_1 + \|Y \|_1\)</span> for <span class="math inline">\(X,Y \in L^1\)</span></li>
<li>For all scalars <span class="math inline">\(a\)</span> and <span class="math inline">\(X \in L^1\)</span>, <span class="math inline">\(\| a X\|_1 = |a| \| X \|_1\)</span></li>
<li>For all <span class="math inline">\(X \in L^1\)</span>, if <span class="math inline">\(\| X\|_1 = 0\)</span>, then <span class="math inline">\(X=0\)</span>.</li>
</ol>
<ol type="1">
<li>By the triangle inequality for the reals,</li>
</ol>
<p><span class="math display">\[
| X + Y| \leq |X| + |Y|
\]</span> with probability one for <span class="math inline">\(X, Y \in L^1\)</span> and so</p>
<p><span class="math display">\[
\| X + Y \|_1 = \E(|X + Y|) \leq \E(|X|) + \E(|Y|) = \|X\|_1 + \|Y\|_1.
\]</span></p>
<ol start="2" type="1">
<li></li>
</ol>
<p>For scalar <span class="math inline">\(a\)</span> and <span class="math inline">\(X \in L^1\)</span>,</p>
<p><span class="math display">\[
\| a X \|_1 = \E(|a X|) = |a| \E(|X|) = |a| \| X \|_1.
\]</span></p>
<ol start="3" type="1">
<li></li>
</ol>
<p>It is clear that if <span class="math inline">\(X = 0\)</span>, then <span class="math inline">\(\|X\|_1 = 0\)</span>.</p>
<p>If <span class="math inline">\(X \in L^1\)</span> and <span class="math inline">\(\| X \|_1 = 0\)</span>, then</p>
<p><span class="math display">\[
\E(|X|) =0.
\]</span></p>
<p>By Markov’s inequality</p>
<p><span class="math display">\[
\P(|X| &gt; x) \leq \frac{1}{x} \E(|X|) = 0
\]</span> for <span class="math inline">\(x &gt; 0\)</span> i.e.</p>
<p><span class="math display">\[
P(|X| &gt; x) = 0
\]</span> for <span class="math inline">\(x&gt; 0\)</span>. It follows that <span class="math inline">\(P(|X| \leq 1/n) = 1\)</span> for all <span class="math inline">\(n=1, 2, \ldots\)</span>.</p>
<p>Therefore, we can create a decreasing, nested sequence of events <span class="math inline">\(A_n = \{\omega \in \Omega : \left |X(\omega)\right| \leq 1/n\}\)</span> and by continuity of probability <span class="math display">\[
\P(X = 0) = \lim_{n\to\infty} P(X \leq 1/n) =  1.
\]</span></p>
<p>Therefore, <span class="math inline">\(X = 0\)</span>.</p>
</section>
<section id="wicks-formula" class="level2">
<h2 class="anchored" data-anchor-id="wicks-formula">2.17 Wick’s Formula</h2>
<ol type="a">
<li>Let <span class="math inline">\(Z=(Z_i)_{i=1}^n\)</span> be IID standard Gaussians and let <span class="math inline">\(G: \mathbb{R}^n \mapsto \mathbb{R}\)</span> be a smooth function for which <span class="math inline">\(\E(G(Z))\)</span> and <span class="math inline">\(\E(\partial_i G(Z))\)</span> are well-defined for every <span class="math inline">\(i \leq n\)</span>. Prove that</li>
</ol>
<p><span class="math display">\[
\E(Z_i G(Z)) = \E(\partial_iG(Z)).
\]</span></p>
<p>Proof:</p>
<p>By integration by parts for the one-dimensional Gaussian and the law of total expectation</p>
<p><span class="math display">\[
\begin{align}
\E(\E(\partial_iG(Z)|\cap_{j\neq i} Z_j)) &amp;= \E(\E(Z_i G(Z)|\cap_{j \neq i} Z_j)) \\
&amp;= E(Z_i G(Z)).
\end{align}
\]</span></p>
<ol start="2" type="a">
<li>Let <span class="math inline">\(X\)</span> be a non-degenerate Gaussian vector of mean zero, and let <span class="math inline">\(F: \mathbb{R}^n \mapsto \mathbb{R}\)</span> be a smooth function for which <span class="math inline">\(\E(F(X))\)</span> and <span class="math inline">\(\E(\partial_iF(X))\)</span> are well-defined for every <span class="math inline">\(i \leq n\)</span>. Prove that</li>
</ol>
<p><span class="math display">\[
\E(X_i F(X)) = \sum_{j \leq n} \E(X_i X_j) \E(\partial_iF(X))
\]</span> for <span class="math inline">\(i \leq n\)</span>.</p>
<div class="callout-warning callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>Typo in the question.</p>
<p>LHS should read <span class="math inline">\(\E(X_i F(X))\)</span> instead of <span class="math inline">\(\E(X_i F(Z))\)</span>.</p>
</div>
</div>
<p>Proof:</p>
<p>Let <span class="math inline">\(A\)</span> be the Cholesky decomposition of the covariance matrix of <span class="math inline">\(X\)</span>. Then</p>
<p><span class="math display">\[
X = AZ
\]</span></p>
<p>where <span class="math inline">\(Z=(Z_i)\)</span> are IID standard Gaussian variables with mean zero.</p>
<p>Define <span class="math inline">\(G(Z) = F(AZ)\)</span>. Then</p>
<p><span class="math display">\[
\begin{align}
\E(Z_i G(Z)) &amp;= \E(\partial_i G(Z)) \\
&amp;= \E(\partial_i F(AZ)) \\
&amp;= \E(\sum_j \partial_j F(X) A_{ji}) \\
&amp;= \sum_j A_{ji} E(\partial_j F(X)) \\.
\end{align}
\]</span></p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Define <span class="math inline">\(a(x) = Ax\)</span>. Then by the chain rule <span class="math display">\[
\begin{align}
\partial_i(F(a_1(x), \ldots, a_n(x))) &amp;= \sum_j \frac{\partial F}{\partial a_j}\frac{\partial a_j}{\partial x_i} \\
&amp;= \sum_j \partial_j F(a_1(x), \ldots, a_n(x)) A_{ji}.
\end{align}
\]</span></p>
</div>
</div>
</div>
<p><span class="math display">\[
\begin{align}
\E(X_i F(X)) &amp;= \E(\sum_k A_{ik} Z_k G(Z)) \\
&amp;= \sum_k A_{ik} \E(\partial_k G(Z)) \\
&amp;= \sum_k A_{ik} \sum_j \E(\partial_j F(X) A_{kj}) \\
&amp;= \sum_j \sum_k A_{ik} A_{kj} \E(\partial_j F(X) ) \\
&amp;= \sum_j  (AA^T)_{ij} \E(\partial_j F(X)) \\
&amp;= \sum_j  \E(X_i X_j) \E(\partial_j F(X)).
\end{align}
\]</span></p>
<ol start="3" type="a">
<li>For any <span class="math inline">\(m\)</span>-tuple <span class="math inline">\((i_1, \ldots , i_m)\)</span> where <span class="math inline">\(i_k \leq n\)</span> we have the <span class="math inline">\(E(X_{i_1}\ldots X_{i_m}) = 0\)</span> if <span class="math inline">\(m\)</span> is odd, and if <span class="math inline">\(m\)</span> is even,</li>
</ol>
<p><span class="math display">\[
\E(X_{i_1} \ldots X_{i_m}) = \sum_{p \in P_m^2} \prod_{p = (p_1, p_2)} \E(X_{p_1} X_{p_2})
\]</span></p>
<p>where <span class="math inline">\(P_m^2\)</span> is the set of all pairing of elements of the <span class="math inline">\(m\)</span>-tuple.</p>
<p>Proof:</p>
<p>For <span class="math inline">\(m=2\)</span>, the result is trivial.</p>
<p>Suppose true for <span class="math inline">\(m\)</span> even. Define <span class="math inline">\(F(X) = X_{i_1} \ldots X_{i_m} X_{i_{m+1}}\)</span></p>
<p>Then</p>
<p><span class="math display">\[
\begin{align}
\E(X_{i_1} \ldots X_{i_{m+2}}) &amp;= \E(F(X) X_{i_{m+2}}) \\
&amp;= \sum_{j \leq m+1} \E(X_{i_{m+2}} X_j) \sum_{p\in P_m} \prod_{p=(p_1, p2)} E(X_{p_1}X_{p_2}) \\
&amp;= \sum_{p \in P_{m+2}^2} \prod_{p = (p_1, p_2)} \E(X_{p_1} X_{p_2}).
\end{align}
\]</span> By induction, the theorem is true for even <span class="math inline">\(m\)</span>.</p>
<p>For <span class="math inline">\(m\)</span> odd, the base case is <span class="math inline">\(m=3\)</span>. Define <span class="math inline">\(F(X) = X_{i_2} X_{i_3}\)</span>.</p>
<p>Then <span class="math display">\[
\begin{align}
\E(X_{i_1} X_{i_2} X_{i_3}) &amp;= \E(X_{i_1} X_{i_2})\E(X_{i_3}) + \E(X_{i_1} X_{i_3}) \E(X_{i_4}) \\
&amp;= 0.
\end{align}
\]</span></p>
<p>Suppose that the theorem is true for odd <span class="math inline">\(m\)</span>. Then for <span class="math inline">\(m+2\)</span>, define <span class="math inline">\(F(X) = X_{i_1}\ldots X_{i_{m+1}}\)</span>.</p>
<p><span class="math display">\[
\begin{align}
\E(X_{i_1} \ldots X_{i_{m+2}}) &amp;= \E(F(X) X_{i_{m+2}}) \\
&amp;= \sum_{j \leq m+2} \E(X_{i_{m+2}}X_j) \E(\partial_j F(X)) \\
&amp;= 0
\end{align}
\]</span></p>
<p>since <span class="math inline">\(\partial_j F(X)\)</span> is the product of an odd number of elements of <span class="math inline">\(X\)</span>.</p>
<p>Another approach to proving the odd case is to appeal to symmetry:</p>
<p>for any <span class="math inline">\(i\)</span>, the distribution of <span class="math inline">\(-X_i\)</span> is the same as that of <span class="math inline">\(X_i\)</span>. Moreover, any product <span class="math inline">\(X_{i_1} \ldots X_{i_n}\)</span> will have the same distribution as <span class="math inline">\((-1)^n X_{i_1} \ldots X_{i_n}\)</span>. Therefore,</p>
<p><span class="math display">\[
\E (X_{i_1} \ldots X_{i_n}) = (-1)^n\E(X_{i_1} \ldots X_{i_n}).
\]</span> When <span class="math inline">\(n\)</span> is odd, <span class="math display">\[
\E (X_{i_1} \ldots X_{i_n}) = -\E(X_{i_1} \ldots X_{i_n}) = 0.
\]</span></p>
<p><span class="math inline">\(\square\)</span></p>
<p>```</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>