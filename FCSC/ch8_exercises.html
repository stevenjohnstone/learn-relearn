<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Solutions to exercises and computer experiments">

<title>Chapter 8 Exercises â€“ learn-relearn</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-5c20c3bb11bfb47ddc70ee6509192fc0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">learn-relearn</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-first-course-in-stochastic-calculus" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">First Course in Stochastic Calculus</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-first-course-in-stochastic-calculus">    
        <li class="dropdown-header">FCSC</li>
        <li>
    <a class="dropdown-item" href="../FCSC/ch1_exercises.html">
 <span class="dropdown-text">Chapter 1 Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../FCSC/ch1_experiments.html">
 <span class="dropdown-text">Chapter 1 Computer Experiments</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../FCSC/ch2_exercises.html">
 <span class="dropdown-text">Chapter 2 Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../FCSC/ch2_experiments.html">
 <span class="dropdown-text">Chapter 2 Computer Experiments</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../FCSC/ch3_exercises.html">
 <span class="dropdown-text">Chapter 3 Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../FCSC/ch3_experiments.html">
 <span class="dropdown-text">Chapter 3 Computer Experiments</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../FCSC/ch4_exercises.html">
 <span class="dropdown-text">Chapter 4 Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../FCSC/ch4_experiments.html">
 <span class="dropdown-text">Chapter 4 Computer Experiments</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../FCSC/ch5_exercises.html">
 <span class="dropdown-text">Chapter 5 Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../FCSC/ch5_experiments.html">
 <span class="dropdown-text">Chapter 5 Computer Experiments</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../FCSC/ch6_exercises.html">
 <span class="dropdown-text">Chapter 6 Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../FCSC/ch6_experiments.html">
 <span class="dropdown-text">Chapter 6 Computer Experiments</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../FCSC/ch7_exercises.html">
 <span class="dropdown-text">Chapter 7 Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../FCSC/ch7_experiments.html">
 <span class="dropdown-text">Chapter 7 Computer Experiments</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../FCSC/ch8_exercises.html">
 <span class="dropdown-text">Chapter 8 Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../FCSC/ch8_experiments.html">
 <span class="dropdown-text">Chapter 8 Computer Experiments</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-probabilistic-machine-learning" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Probabilistic Machine Learning</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-probabilistic-machine-learning">    
        <li class="dropdown-header">PML</li>
        <li>
    <a class="dropdown-item" href="../PML/ch2.html">
 <span class="dropdown-text">Chapter Two Exercises</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../FCSC/ch1_exercises.html">FCSC</a></li><li class="breadcrumb-item"><a href="../FCSC/ch8_exercises.html">Chapter 8 Exercises</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">FCSC</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../FCSC/ch1_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 1 Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../FCSC/ch1_experiments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 1 Computer Experiments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../FCSC/ch2_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 2 Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../FCSC/ch2_experiments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 2 Computer Experiments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../FCSC/ch3_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 3 Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../FCSC/ch3_experiments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 3 Computer Experiments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../FCSC/ch4_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 4 Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../FCSC/ch4_experiments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 4 Computer Experiments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../FCSC/ch5_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 5 Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../FCSC/ch5_experiments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 5 Computer Experiments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../FCSC/ch6_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 6 Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../FCSC/ch6_experiments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 6 Computer Experiments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../FCSC/ch7_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 7 Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../FCSC/ch7_experiments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 7 Computer Experiments</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../FCSC/ch8_exercises.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Chapter 8 Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../FCSC/ch8_experiments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Chapter 8 Computer Experiments</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../FCSC/ch1_exercises.html">FCSC</a></li><li class="breadcrumb-item"><a href="../FCSC/ch8_exercises.html">Chapter 8 Exercises</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Chapter 8 Exercises</h1>
</div>

<div>
  <div class="description">
    Solutions to exercises and computer experiments
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>

<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#future-and-past-are-independent-given-the-present" id="toc-future-and-past-are-independent-given-the-present">8.1 Future and Past Are Independent Given the Present</a></li>
  <li><a href="#brownian-probabilities-revisited" id="toc-brownian-probabilities-revisited">8.2 Brownian Probabilities Revisited</a></li>
  <li><a href="#markovariance" id="toc-markovariance">8.3 Markovariance</a></li>
  <li><a href="#shifted-brownian-motion" id="toc-shifted-brownian-motion">8.4 Shifted Brownian Motion</a></li>
  <li><a href="#brownian-motion-with-drift-is-a-markov-process" id="toc-brownian-motion-with-drift-is-a-markov-process">8.5 Brownian Motion with Drift is a Markov Process</a></li>
  <li><a href="#adding-a-constant-drift" id="toc-adding-a-constant-drift">8.6 Adding A Constant Drift</a></li>
  <li><a href="#geometric-brownian-motion-as-a-markov-process" id="toc-geometric-brownian-motion-as-a-markov-process">8.7 Geometric Brownian Motion as a Markov Process</a></li>
  <li><a href="#invariant-probability-of-the-ornstein-uhlenbeck-process" id="toc-invariant-probability-of-the-ornstein-uhlenbeck-process">8.8 Invariant Probability of the Ornstein-Uhlenbeck Process</a></li>
  <li><a href="#smoluchowskis-equation" id="toc-smoluchowskis-equation">8.9 Smoluchowskiâ€™s Equation</a></li>
  <li><a href="#cir-model-as-a-markov-process" id="toc-cir-model-as-a-markov-process">8.10 CIR Model as a Markov Process</a></li>
  <li><a href="#feynman-kac-with-terminal-value" id="toc-feynman-kac-with-terminal-value">8.11 Feynman-Kac with Terminal Value</a></li>
  <li><a href="#b_t2-is-a-markov-process" id="toc-b_t2-is-a-markov-process">8.12 <span class="math inline">\(B_t^2\)</span> is a Markov Process</a></li>
  <li><a href="#generator-of-a-poisson-process" id="toc-generator-of-a-poisson-process">8.13 Generator of a Poisson Process</a></li>
  </ul>
</nav>
<div class="hidden">
<p><span class="math display">\[
\newcommand{\Cov}{\operatorname{Cov}}
\newcommand{\Var}{\operatorname{Var}}
\newcommand{\E}{\operatorname{E}}
\newcommand{\P}{\operatorname{P}}
\newcommand{\rank}{\operatorname{rank}}
\newcommand{\trace}{\operatorname{trace}}
\newcommand{\sgn}{\operatorname{sgn}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\G}{\mathcal{G}}
\newcommand{\qed}{\tag*{$\square$}}
\newcommand{\erf}{\operatorname{erf}}
\newcommand{\sgn}{\operatorname{sgn}}
\newcommand{\1}{\mathbb{1}}
\def\iddots{{\kern3mu\raise1mu{.}\kern3mu\raise6mu{.}\kern3mu
\raise12mu{.}}}
\]</span></p>
</div>
<section id="future-and-past-are-independent-given-the-present" class="level2">
<h2 class="anchored" data-anchor-id="future-and-past-are-independent-given-the-present">8.1 Future and Past Are Independent Given the Present</h2>
<p>Let <span class="math inline">\((X_t, t \geq 0)\)</span> be a Markov process with its natural filtration <span class="math inline">\((\F_t, t \geq 0)\)</span>. For any bounded, measurable functions, <span class="math inline">\(g\)</span> and <span class="math inline">\(h\)</span> and any <span class="math inline">\(0 \leq r &lt; s &lt; t \leq \infty\)</span></p>
<p><span class="math display">\[
\E(g(X_t)h(X_r)|X_s) = \E(g(X_t)|X_s)\E(h(X_r)|X_s).
\]</span></p>
<p>Proof:</p>
<p>Since <span class="math display">\[
\sigma(X_r) \subseteq \F_s,
\]</span> <span class="math inline">\(h(X_r)\)</span> is <span class="math inline">\(F_s\)</span>-measurable and since <span class="math display">\[
\sigma(X_s) \subseteq \F_s,
\]</span></p>
<p>the tower property can be used:</p>
<p><span class="math display">\[
\begin{align}
\E(g(X_t) h(X_r) | X_s) &amp;= \E(\E(g(X_t) h(X_r) |\underbrace{\F_s)|X_s)}_{\text{tower property}} \\
&amp;=\E(\underbrace{h(X_r)}_{\F_s\text{-measurable}} \E(g(X_t) | \F_s) | X_s) \\
&amp;= \E(h(X_r) \underbrace{\E(g(X_t) | X_s) }_{\text{Markov property}}|X_s) \\
&amp;= \underbrace{\E(g(X_t) | X_s)}_{X_s\text{-measurable}} \E(h(X_r) | X_s).
\end{align}
\]</span></p>
<p><span class="math display">\[
\qed
\]</span></p>
</section>
<section id="brownian-probabilities-revisited" class="level2">
<h2 class="anchored" data-anchor-id="brownian-probabilities-revisited">8.2 Brownian Probabilities Revisited</h2>
<section id="a" class="level4">
<h4 class="anchored" data-anchor-id="a">(a)</h4>
<p>With <span class="math inline">\(A = (1, \infty)\)</span>: probability: <span class="math display">\[
\begin{align}
\P(B_1 &gt; 1, B_2 &gt; 1) &amp;= \P(B_1 \in A, B_2 \in A) \\
&amp;= \E(\1_A(B_1)\1_A(B_2)) \\
&amp;= \E(\E(\1_A(B_1)\1_A(B_2) | \F_1))\\
&amp;= \E(\underbrace{\1_A(B_1)}_{\F_1\text{-measurable}} \E(\1_A(B_2) | \F_1)) \\
&amp;= \E(\1_A(B_1) \underbrace{\E(\1_A(B_2) | B_1)}_{\text{Markov condition}}) \\
&amp;= \int_A \left(\int_A p_1(x, y) d y\right) p_1(B_0, x) dx \\
&amp;= \frac{1}{2 \pi}\int_1^{\infty}\int_1^{\infty} e^{\frac{-(y-x)^2}{2}} e^{\frac{-x^2}{2}} dx\,dy \\
&amp;= \frac{1}{2 \pi} \int_1^{\infty}\int_1^{\infty} e^{-x^2 + xy - y^2/2} dx\, dy.
\end{align}
\]</span></p>
</section>
<section id="b" class="level4">
<h4 class="anchored" data-anchor-id="b">(b)</h4>
<p>Let <span class="math inline">\(A = (1, \infty)\)</span>. In this example, the Markov property is required because the tower <span class="math display">\[
\F_1 \subseteq \F_2
\]</span> is exploited:</p>
<p><span class="math display">\[
\begin{align}
\P(B_1 &gt; 1, B_2 &gt; 1, B_3 &gt; 1) &amp;= \E(\1_A(B_1) \1_A(B_2) \1_A(B_3)) \\
&amp;= \E(\E(\1_A(B_1) \1_A(B_2) \1_A(B_3) | \F_1)) \\
&amp;= \E( \1_A(B_1) \E(\1_A(B_2) \1_A(B_3) | \F_1)) \\
&amp;= \E( \1_A(B_1) \underbrace{\E(\E(\1_A(B_2) \1_A(B_3)|\F_2)|\F_1))}_{\F_1 \subseteq \F_2, \text{ tower}} \\
&amp;= \E( \1_A(B_1) \E(\1_A(B_2)\E(\1_A(B_3)|\F_2)|\F_1)) \\
&amp;= \E( \1_A(B_1) \E(\underbrace{\1_A(B_2)\E(\1_A(B_3)|B_2)}_{\text{bounded function of $B_2$}}|\F_1)) \\
&amp;= \E( \1_A(B_1) \E(\1_A(B_2) \E(\1_A(B_3) | B_2) | B_1)) \\
&amp;= \int_A \left(\int_A \left( \int_A p_1(y, z)dz\right) p_1(x, y) dy \right) p_1(B_0, x) dx \\
&amp;= \int_1^{\infty}\int_1^{\infty}\int_1^{\infty} p_1(B_0, x) p_1(x, y) p_1(y, z) dx\, dy\, dz \\
&amp;= \int_1^{\infty}\int_1^{\infty}\int_1^{\infty}  p_1(x, y) p_1(y, z) dx\, dy\, dz \\
&amp;= \frac{\sqrt{2}}{4 \pi^{\frac{3}{2}}} \int_1^{\infty} \int_1^{\infty} \int_1^{\infty} e^{-x^2 + xy - y^2 + yz - z^2/2} dx\, dy\, dz.
\end{align}
\]</span></p>
</section>
</section>
<section id="markovariance" class="level2">
<h2 class="anchored" data-anchor-id="markovariance">8.3 Markovariance</h2>
<section id="a-1" class="level4">
<h4 class="anchored" data-anchor-id="a-1">(a)</h4>
<p>For any intervals <span class="math inline">\(A_1, A_2 \subseteq \mathbb{R}\)</span> and <span class="math inline">\(s &lt; t\)</span>,</p>
<p><span class="math display">\[
\P(B_s \in A_1, B_t \in A_2) = \int_{A_1} \int_{A_2}
\frac{
  e^{-\frac{(y-x)^2}{2(t-s)}}e^{-\frac{x^2}{2s}}}{\sqrt{2\pi(t-s)}\sqrt{2\pi s}} dy \, dx.
\]</span></p>
<p>Proof:</p>
<p><span class="math display">\[
\begin{align}
\P(B_s \in A_1, B_t \in A_2) &amp;= \E(\1_{A_1}(B_s) \1_{A_2}(B_t)) \\
&amp;= \E(\E(\1_{A_1}(B_s)\1_{A_2}(B_t)|\F_s)) \\
&amp;= \E(\1_{A_1}(B_s) \E(\1_{A_2}(B_t)|\F_s)) \\
&amp;= \E(\1_{A_1}(B_s) \E(\1_{A_2}(B_t)| B_s)) \\
&amp;= \int_{A_1} \left(\int_{A_2} p_{t-s}(x, y)\, dy\right) p_s(B_0, x) \, dx \\
&amp;= \int_{A_1} \int_{A_2} \frac{e^{-\frac{(y-x)^2}{2(t-s)}}}{\sqrt{2 \pi (t-s)}} \frac{e^{-\frac{x^2}{2s}}}{\sqrt{2 \pi s}} dy \, dx.
\end{align}
\]</span></p>
</section>
</section>
<section id="shifted-brownian-motion" class="level2">
<h2 class="anchored" data-anchor-id="shifted-brownian-motion">8.4 Shifted Brownian Motion</h2>
<p>Fix <span class="math inline">\(t &gt; 0\)</span> and define <span class="math display">\[
W_s = B_{t+s} - B_t
\]</span> for <span class="math inline">\(s\geq 0\)</span>. Then <span class="math inline">\(W_s\)</span> is a standard Brownian motion independent of <span class="math inline">\(\F_t\)</span>.</p>
<p>Proof:</p>
<p><span class="math inline">\((W_s)\)</span> is a Gaussian process as it is the sum of Gaussian processes. The mean is zero:</p>
<p><span class="math display">\[
\E(W_s) = \E(B_{t + s}) - \E(B_s) = 0 - 0 = 0.
\]</span></p>
<p>The variance is given by</p>
<p><span class="math display">\[
\begin{align}
\E(W_a W_b) &amp;= \E((B_{t + a} - B_{t})(B_{t+ b} - B_t)) \\
&amp;= \E(B_{t+a} B_{t+b} - B_{t+a} B_t - B_t B_{t + b} + B_t^2) \\
&amp;= (t +a) \wedge (t + b) - (t+a) \wedge t - t \wedge (t + b) + t \\
&amp;= t + (a \wedge b) - t - t + t \\
&amp;= a \wedge b.
\end{align}
\]</span></p>
<p>For almost every <span class="math inline">\(\omega\)</span>, <span class="math inline">\(s \mapsto W_s(\omega)\)</span> is continuous, by continuity of <span class="math inline">\(B_s\)</span>. Therefore, <span class="math inline">\((W_s)\)</span> is a standard Brownian motion.</p>
<p>For any <span class="math inline">\(t' \leq t\)</span>, <span class="math inline">\(W_s\)</span> is independent of <span class="math inline">\(\sigma(B_{t'})\)</span>, because the increments of the Brownian motion <span class="math inline">\(B\)</span> are independent. It follows that <span class="math inline">\((W_s)\)</span> is independent of <span class="math inline">\(\F_t\)</span>.</p>
<p><span class="math display">\[
\qed
\]</span></p>
</section>
<section id="brownian-motion-with-drift-is-a-markov-process" class="level2">
<h2 class="anchored" data-anchor-id="brownian-motion-with-drift-is-a-markov-process">8.5 Brownian Motion with Drift is a Markov Process</h2>
<p><span class="math display">\[
X_t = \sigma B_t + \mu t,
\]</span> for <span class="math inline">\(t\geq 0\)</span>.</p>
<section id="a-2" class="level4">
<h4 class="anchored" data-anchor-id="a-2">(a)</h4>
<p><span class="math inline">\(X_t\)</span> is a Markov process.</p>
<p>Proof:</p>
<p>Let <span class="math inline">\(\F_t\)</span> be the natural filtration of <span class="math inline">\(B_t\)</span> and note that it is also the natural filtration for <span class="math inline">\(X_t\)</span>. In fact, <span class="math inline">\(\sigma(B_t) = \sigma(X_t)\)</span></p>
<p>Now, for <span class="math inline">\(s \leq t\)</span>,</p>
<p><span class="math display">\[
\begin{align}
\E(X_t| \F_s) &amp;= \E(\sigma X_t + \mu t | \F_s) \\
&amp;= \sigma \E(B_t | \F_s) + \mu t \\
&amp;= \sigma \E(B_t | B_s) + \mu t \E(1 | B_s) \\
&amp;= \E(\sigma B_t + \mu t | B_s) \\
&amp;= \E (X_t | B_s) \\
&amp;= \E (X_t | X_s).
\end{align}
\]</span> <span class="math display">\[
\qed
\]</span></p>
</section>
<section id="b-1" class="level4">
<h4 class="anchored" data-anchor-id="b-1">(b)</h4>
<p><span class="math inline">\(X_t\)</span> has normal distribution with mean <span class="math inline">\(\mu t\)</span> and variance <span class="math inline">\(\sigma^2t\)</span> it follows that the probability density function <span class="math inline">\(f_t\)</span> of <span class="math inline">\(X_t\)</span> is given by</p>
<p><span class="math display">\[
f_t(x) = \frac{1}{\sigma \sqrt{2\pi t}} \exp\left(-\frac{1}{2 \sigma^2 t}(x - \mu t)^2\right).
\]</span></p>
</section>
<section id="c" class="level4">
<h4 class="anchored" data-anchor-id="c">(c)</h4>
<p>The generator <span class="math inline">\(A\)</span> of <span class="math inline">\(X_t\)</span> is given by</p>
<p><span class="math display">\[
A = \frac{\sigma^2}{2}\partial^2_x + \mu \partial_x.
\]</span></p>
<p>The adjoint <span class="math inline">\(A^*\)</span> is given by</p>
<p><span class="math display">\[
A^* = \frac{\sigma^2}{2}\partial^2_x - \mu \partial_x.
\]</span></p>
</section>
</section>
<section id="adding-a-constant-drift" class="level2">
<h2 class="anchored" data-anchor-id="adding-a-constant-drift">8.6 Adding A Constant Drift</h2>
<p>Let <span class="math inline">\((X_t, t \geq 0)\)</span> be a Markov process. The process defined <span class="math display">\[
Y_t = X_t + \mu t
\]</span> for some <span class="math inline">\(\mu \neq 0\)</span> is Markov.</p>
<p>Proof:</p>
<p>Let <span class="math inline">\(0 \leq s \leq t &lt; \infty\)</span>. Let <span class="math inline">\((\F_t, t \geq 0)\)</span> be the natural filtration of <span class="math inline">\((X_t)\)</span>: <span class="math inline">\((\F_t, t\geq 0)\)</span> is also the natural filtration for <span class="math inline">\((Y_t, t \geq 0)\)</span> since <span class="math inline">\(\sigma(X_s) = \sigma(Y_s)\)</span>.</p>
<p><span class="math display">\[
\begin{align}
\E(Y_t | \F_s) &amp;= \E(X_t |\F_s) + \mu t \\
&amp;= \E(X_t | X_s) + \mu t \E(1 | X_s) \\
&amp;= \E(Y_t | X_s) \\
&amp;= \E(Y_t | Y_s).
\end{align}
\]</span> <span class="math display">\[
\qed
\]</span></p>
</section>
<section id="geometric-brownian-motion-as-a-markov-process" class="level2">
<h2 class="anchored" data-anchor-id="geometric-brownian-motion-as-a-markov-process">8.7 Geometric Brownian Motion as a Markov Process</h2>
<p>Let <span class="math inline">\(S_t\)</span> satisfy</p>
<p><span class="math display">\[
d S_t = \sigma S_t dB_t
\]</span> for some <span class="math inline">\(\sigma\)</span>.</p>
<section id="a-3" class="level4">
<h4 class="anchored" data-anchor-id="a-3">(a)</h4>
<p><span class="math inline">\((S_t, t \geq 0)\)</span> is Markov.</p>
<p>Proof:</p>
<p><span class="math display">\[
S_t = S_0 \exp(\sigma B_t -\frac{\sigma^2t}{2})
\]</span> satisfies the SDE. For <span class="math inline">\(t \geq 0\)</span>, <span class="math inline">\(\sigma(S_t) = \sigma(B_t)\)</span> and so the natural filtration of <span class="math inline">\((B_t)\)</span> is the natural filtration of <span class="math inline">\((S_t)\)</span>. For any be a bounded measurable function <span class="math inline">\(g\)</span>, the function <span class="math inline">\(h\)</span> defined</p>
<p><span class="math display">\[
h(x) = g(S_0 \exp(x - \frac{\sigma^2t}{2}))
\]</span> is also bounded and measurable. Since <span class="math inline">\(B_t\)</span> is Markov, it follows that <span class="math display">\[
\E(h(B_t) | \F_s) = \E(h(B_t) | B_s).
\]</span> Therefore, <span class="math display">\[
\begin{align}
\E(g(S_t) | \F_s) &amp;= \E(h(B_t) | \F_s) \\
&amp;= \underbrace{\E(h(B_t) | B_s)}_{\text{Markov property}} \\
&amp;= \E(g(S_t) | B_s) \\
&amp;= \E(g(S_t) | S_s).
\end{align}
\]</span> <span class="math display">\[
\qed
\]</span></p>
</section>
<section id="b-2" class="level4">
<h4 class="anchored" data-anchor-id="b-2">(b)</h4>
<p>If <span class="math inline">\(p_{s,t}\)</span> is the transition probability density of the standard Brownian motion</p>
<p><span class="math display">\[
\begin{align}
\E(g(S_t) | S_s = x) &amp;= \E(h(B_t) | B_s = \frac{1}{\sigma}(\log(x /S_0) + \sigma^2 s /2)) \\
&amp;= \int_{\mathbb{R}} h(y) p_{s, t}(\frac{1}{\sigma}(\log(x/S_0) + \sigma^2 s /2), y) \, dy \\
&amp;= \int_{\mathbb{R}} h(y) \frac{e^{-\frac{(y - \frac{1}{\sigma}(\log(x/S_0) + \sigma^2 s/2))^2}{2(t - s)}}}{\sqrt{2\pi(t - s)}} \, dy \\
&amp;= \int_{\mathbb{R}} g(S_0 \exp(\sigma y - \frac{\sigma^2t}{2})) \frac{e^{-\frac{(\sigma y - log(x/S_0) - \sigma^2 s/2)^2}{2(t - s)\sigma^2}}}{\sqrt{2\pi(t - s)}} \, dy \\
&amp;= \int_{\mathbb{R}} g(S_0 \exp(y)) \frac{e^{-\frac{(y - \log(x/S_0) + \sigma^2(t -s)/2)^2}{2(t - s)\sigma^2}}}{\sqrt{2\pi(t - s)\sigma^2}} \, dy \\
&amp;= \int_0^{\infty} g(y) \frac{e^{-\frac{(\log(y) - \log(x) + \sigma^2(t-s)/2)^2}{2(t -s) \sigma^2}}}{\sqrt{2 \pi (t - s) \sigma^2}} \frac{dy}{y}.
\end{align}
\]</span></p>
<p>The transition probability density of <span class="math inline">\(S_t\)</span> is</p>
<p><span class="math display">\[
p_t(x, y) =
\begin{cases}
\frac{1}{y \sqrt{2 \pi t \sigma^2}} e^{-\frac{(\log(y) - \log(x) +\sigma^2 t/2)^2}{2t \sigma^2}} &amp; y &gt; 0 \\
0 &amp; \text{otherwise}.
\end{cases}
\]</span></p>
</section>
<section id="c-1" class="level4">
<h4 class="anchored" data-anchor-id="c-1">(c)</h4>
<p>The backward equation with initial value is</p>
<p><span class="math display">\[
\partial_t f = \frac{\sigma^2 x^2}{2} \partial_x^2 f
\]</span> with <span class="math display">\[
f(0, x) = g(x).
\]</span></p>
<p>The backward equation with terminal value is <span class="math display">\[
\partial_t f = -\frac{\sigma^2 x^2}{2} \partial_x^2 f
\]</span> with <span class="math display">\[
f(T, x) = g(x).
\]</span></p>
</section>
<section id="d" class="level4">
<h4 class="anchored" data-anchor-id="d">(d)</h4>
<p>For this process <span class="math display">\[
A = \frac{\sigma^2 x^2}{2} \partial_x^2.
\]</span> Its adjoint is <span class="math display">\[
A^* = \frac{1}{2} \partial_x^2( \sigma^2 x^2) = \frac{\sigma^2}{2}(x^2 \partial_x^2 + 4x \partial_x + 2).
\]</span></p>
<p>The forward equation with initial value is</p>
<p><span class="math display">\[
\partial_t f = \frac{\sigma^2}{2}(x^2 \partial_x^2 f + 4x \partial_x f + 2 f)
\]</span> with <span class="math display">\[
f(0, y) = \delta_{x_0}.
\]</span></p>
</section>
<section id="e" class="level4">
<h4 class="anchored" data-anchor-id="e">(e)</h4>
<p>The following demonstrates that <span class="math display">\[
f(t, y) = p_t(x, y)
\]</span> satisfies the forward equation:</p>
<div id="9799cf7d" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sympy.abc <span class="im">import</span> x,y,t,sigma</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, Markdown</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>sp.init_printing(use_latex<span class="op">=</span><span class="st">'mathjax'</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> (<span class="dv">1</span><span class="op">/</span>(y<span class="op">*</span>sp.sqrt(<span class="dv">2</span> <span class="op">*</span> sp.pi <span class="op">*</span> t <span class="op">*</span> sigma<span class="op">**</span><span class="dv">2</span>))) <span class="op">*</span> sp.exp(<span class="op">-</span>((sp.log(y) <span class="op">-</span> sp.log(x) <span class="op">+</span> (<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) <span class="op">*</span>t<span class="op">*</span>sigma<span class="op">**</span><span class="dv">2</span>)<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span>(<span class="dv">2</span> <span class="op">*</span> t <span class="op">*</span> sigma<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Astar(g):</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span> sp.diff((sigma<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>(y<span class="op">**</span><span class="dv">2</span>) <span class="op">*</span> g, y, <span class="dv">2</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>display(Markdown(<span class="ss">f'$\partial_t f - A^* f = </span><span class="sc">{</span> (sp.diff(f, t) <span class="op">-</span> Astar(f))<span class="sc">.</span>simplify()<span class="sc">}</span><span class="ss">$'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>&lt;&gt;:11: SyntaxWarning: invalid escape sequence '\p'
&lt;&gt;:11: SyntaxWarning: invalid escape sequence '\p'
/tmp/ipykernel_2864/1593781429.py:11: SyntaxWarning: invalid escape sequence '\p'
  display(Markdown(f'$\partial_t f - A^* f = { (sp.diff(f, t) - Astar(f)).simplify()}$'))</code></pre>
</div>
<div class="cell-output cell-output-display cell-output-markdown">
<p><span class="math inline">\(\partial_t f - A^* f = 0\)</span></p>
</div>
</div>
</section>
</section>
<section id="invariant-probability-of-the-ornstein-uhlenbeck-process" class="level2">
<h2 class="anchored" data-anchor-id="invariant-probability-of-the-ornstein-uhlenbeck-process">8.8 Invariant Probability of the Ornstein-Uhlenbeck Process</h2>
<p>Consider the Ornstein-Uhlenbeck process with SDE <span class="math display">\[
\begin{align}
d X_t = d B_t - X_t dt, &amp;&amp; t \geq 0, &amp;&amp; X_0 = x,
\end{align}
\]</span></p>
<section id="a-4" class="level4">
<h4 class="anchored" data-anchor-id="a-4">(a)</h4>
<p>The Ornstein-Uhlenbeck process is given by <span class="math display">\[
X_t = X_0 e^{-t} + e^{-t} \int_0^t e^s dB_s.
\]</span></p>
<p>It is a Gaussian process with mean</p>
<p><span class="math display">\[
\begin{align}
\E(X_t) &amp;= \E(x e^{-t} + e^{-t} \int_0^t e^s dB_s) \\
&amp;= x e^{-t}.
\end{align}
\]</span></p>
<p>The variance is found using Itoâ€™s isometry:</p>
<p><span class="math display">\[
\begin{align}
\E(X_t^2) - \E(X_t)^2 &amp;= e^{-2t}  \E((\int_0^t e^s d B_s)^2) \\
&amp;= e^{-2t} \int_0^t e^{2s} ds \\
&amp;= e^{-2t} \frac{1}{2}(e^{2t} - 1) \\
&amp;= \frac{1}{2}(1 - e^{-2t}).
\end{align}
\]</span></p>
<p>Therefore, the probability density at <span class="math inline">\(t\)</span> given starting point <span class="math inline">\(x\)</span> is</p>
<p><span class="math display">\[
\frac{1}{\sqrt{\pi (1 - e^{-2t})}} e^{-\frac{(y - xe^{-t})^2}{(1 - e^{-2t})}}.
\]</span></p>
<p>This is the transition probability density for <span class="math inline">\(X_t\)</span> with <span class="math inline">\(X_0 = x\)</span> but it is also the transition probability density for <span class="math inline">\(X_{s + t}\)</span> given <span class="math inline">\(X_s= x\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math display">\[
Y_t = \int_0^t e^s d B_s
\]</span></p>
<p>and for bounded, measurable <span class="math inline">\(g\)</span> define <span class="math display">\[
h(x) = g(X_0 e^{-t} + e^{-t} x).
\]</span> Then the transition probability for <span class="math inline">\(X_t\)</span> can be expressed in terms of the transition probability of <span class="math inline">\(Y_t\)</span>: <span class="math display">\[
\begin{align}
\E(g(X_t) | X_s = x) &amp;= \E(h(Y_t) | X_s = x) \\
&amp;= \E(h(Y_t) | Y_s = e^{s}(x - X_0 e^{-s})) \\
&amp;= \E(h(Y_t) | Y_s = e^s x - X_0)
\end{align}
\]</span></p>
<p>The process <span class="math inline">\((Y_t)\)</span> is Gaussian and the covariance between different points in time can be calculated using Itoâ€™s isometry:</p>
<p><span class="math display">\[
\begin{align}
\E(Y_s Y_t) &amp;= \int_0^s e^{2u} du \\
&amp;= \frac{1}{2}(e^{2s} - 1)
\end{align}
\]</span> when <span class="math inline">\(s \leq t\)</span>.</p>
<p><span class="math inline">\((Y_s, Y_t)\)</span> is a Gaussian vector and so the conditional distribution can be <a href="https://en.wikipedia.org/wiki/Multivariate_normal_distribution">calculated using standard formulas for the bivariate normal distribution</a> as <span class="math display">\[
\begin{align}
Y_t | Y_s &amp;= x \sim \mathcal{N}(x, \frac{e^{2t} - e^{2s}}{2}).
\end{align}
\]</span></p>
<p>Alternatively, the martingale and Markov properties of <span class="math inline">\(Y_t\)</span> can be exploited to give <span class="math display">\[
\begin{align}
\E(Y_t | Y_s) &amp;= \E(Y_t | \F_s) \\
&amp;= Y_s
\end{align}
\]</span> giving the mean <span class="math display">\[
\E(Y_t | Y_s = x) = x.
\]</span> The conditional variance can be calculated as <span class="math display">\[
\begin{align}
\E(Y_t^2 | Y_s) &amp;= \E(Y_t^2 | \F_s) \\
&amp;= \E((Y_t - Y_s + Y_s)^2 | \F_s) \\
&amp;= \E(\underbrace{(Y_t - Y_s)^2}_{\text{independent of $\F_s$}} + 2 Y_s Y_t - 2Y_s^2 + Y_s^2 | \F_s) \\
&amp;= \E((Y_t - Y_s)^2) + 2Y_s \E(Y_t) - Y_s^2 \\
&amp;= \E(Y_t^2) - E(2Y_s Y_t) + \E(Y_s^2) - Y_s^2 \\
&amp;= \E(Y_t^2) - \E(Y_s^2) - Y_s^2 \\
&amp;= \frac{1}{2}(e^{2t} - e^{2s}) - Y_s^2
\end{align}
\]</span> and so <span class="math display">\[
\E(Y_t^2 | Y_s = x) - \E(Y_t | Y_s = x)^2 = \frac{1}{2}(e^{2t} - e^{2s}).
\]</span></p>
<p>With straight forward changes of variable: <span class="math display">\[
\begin{align}
\E(h(Y_t) | Y_s = e^s x - X_0) &amp;= \int_{-\infty}^{\infty}  h(y) \frac{e^{-\frac{(y - (e^s x - X_0))^2}{e^{2t} - e^{2s}}}}{\sqrt{ \pi (e^{2t} - e^{2s})}} \, dy \\
&amp;=  \int_{-\infty}^{\infty}  g(X_0 e^{-t} + e^{-t} y) \frac{e^{-\frac{(y - (e^s x - X_0))^2}{e^{2t} - e^{2s}}}}{\sqrt{ \pi (e^{2t} - e^{2s})}} \, dy \\
&amp;=  \int_{-\infty}^{\infty}  g(y) \frac{e^{-\frac{(e^t(y - X_0e^{-t}) - (e^s x - X_0))^2}{e^{2t} - e^{2s}}}}{\sqrt{ \pi (e^{2t} - e^{2s})}} \, e^t dy \\
&amp;=  \int_{-\infty}^{\infty}  g(y) \frac{e^{-\frac{e^{2t}(y - e^{s-t} x))^2}{e^{2t} - e^{2s}}}}{\sqrt{ \pi (e^{2t} - e^{2s})}} \, e^t dy \\
&amp;=  \int_{-\infty}^{\infty}  g(y) \frac{e^{-\frac{(y - e^{-(t -s)} x))^2}{1 - e^{-2(t - s)}}}}{\sqrt{ \pi (1 - e^{-2(t - s)})}} \, dy.
\end{align}
\]</span></p>
</div>
</div>
<p>Therefore,</p>
<p><span class="math display">\[
p_t(x, y) = \frac{1}{\sqrt{\pi(1 - e^{-2t})}} e^{-\frac{(y - x e^{-t})^2}{(1 - e^{-2t})}}.
\]</span></p>
</section>
<section id="b-3" class="level4">
<h4 class="anchored" data-anchor-id="b-3">(b)</h4>
<p><span class="math display">\[
\lim_{t \to \infty} p_t(x, y) = \frac{1}{\sqrt{\pi}} e^{-y^2}.
\]</span></p>
</section>
<section id="c-2" class="level4">
<h4 class="anchored" data-anchor-id="c-2">(c)</h4>
<p><span class="math display">\[
\begin{align}
A^*f &amp;= \frac{1}{2} \partial_x^2( \sigma^2(x) f) - \partial_x(\mu(x) f) \\
&amp;= \frac{1}{2} \partial_x^2 f + \partial_x(x f) \\
&amp;= \frac{1}{2} \partial_x^2 + x \partial_x f + f.
\end{align}
\]</span> Therefore, if <span class="math inline">\(f = e^{x^2}\)</span>, then <span class="math display">\[
\begin{align}
A^*f &amp;= \frac{1}{2} \partial_x^2 f + x \partial_x f  + f\\
&amp;= \frac{1}{2}\partial_x( (-2x) e^{-x^2}) - 2x^2 f  + f\\
&amp;= -f  - x(-2x) f - 2x^2 f + f \\
&amp;= 2x^2f - 2x^2 f \\
&amp;= 0.
\end{align}
\]</span></p>
</section>
<section id="d-1" class="level4">
<h4 class="anchored" data-anchor-id="d-1">(d)</h4>
<p>For the more general SDE <span class="math display">\[
d X_t = \sigma d B_t - k X_t dt
\]</span> the solution is <span class="math display">\[
X_t = X_0 e^{-kt} + e^{-kt} \int_0^t e^{ks} \sigma dB_s.
\]</span></p>
<p>The mean is <span class="math display">\[
\begin{align}
\E(X_t) &amp;= X_0 e^{-kt}
\end{align}
\]</span> and the variance is <span class="math display">\[
\begin{align}
\E(X_t^2) - \E(X_t)^2 &amp;= e^{-2kt} \E((\int_0^t e^{ks} \sigma dB_s)^2) \\
&amp;= e^{-2kt} \int_0^t \sigma^2 e^{2ks} ds \\
&amp;= e^{-2kt} \frac{\sigma^2}{2k}(e^{2kt} - 1) \\
&amp;= \frac{\sigma^2}{2k} (1 - e^{-2kt}).
\end{align}
\]</span> Therefore, the transition probability density function is <span class="math display">\[
p_t(x, y) = \frac{1}{\sigma \sqrt{\pi (1 - e^{-2kt}) /k}} e^{- \frac{k (y - xe^{-kt})^2}{\sigma^2(1 - e^{-2kt})}}
\]</span> and <span class="math display">\[
\lim_{t \to \infty} p_t(x, y) = \frac{1}{\sigma} \sqrt{\frac{k}{\pi}} e^{-\frac{ky^2}{\sigma^2}}.
\]</span></p>
<p>It is expected that <span class="math inline">\(f = e^{-\frac{kx^2}{\sigma^2}}\)</span> satisfies <span class="math display">\[
A^* f = 0.
\]</span> Indeed, <span class="math display">\[
\begin{align}
A^* f &amp;= \frac{1}{2} \partial_x^2(\sigma^2(x) f) - \partial_x(\mu(x) f) \\
&amp;= \frac{\sigma^2}{2} \partial_x^2 f + k \partial_x (x f) \\
&amp;= \frac{\sigma^2}{2} \partial_x(-\frac{2kx}{\sigma^2} f) +k f -kx\frac{2kx}{\sigma^2} f \\
&amp;= \frac{\sigma^2}{2} (-\frac{2k}{\sigma^2} f + (\frac{2kx}{\sigma^2})^2f) +k f -kx\frac{2kx}{\sigma^2} f \\
&amp;= -k f + \frac{2k^2 x^2}{\sigma^2} f + k f - \frac{2 k^2 x^2}{\sigma^2} f \\
&amp;= 0.
\end{align}
\]</span></p>
</section>
</section>
<section id="smoluchowskis-equation" class="level2">
<h2 class="anchored" data-anchor-id="smoluchowskis-equation">8.9 Smoluchowskiâ€™s Equation</h2>
<section id="a-5" class="level4">
<h4 class="anchored" data-anchor-id="a-5">(a)</h4>
<p>The invariant distribution <span class="math display">\[
f(x) = C e^{-2V(t)}
\]</span> is a solution of <span class="math display">\[
A^* f = 0
\]</span> where <span class="math inline">\(A^*\)</span> is the adjoint of the generator of the diffusion given by the SDE</p>
<p><span class="math display">\[
d X_t = d B_t - V'(X_t) dt
\]</span> for <span class="math inline">\(t \geq 0\)</span> with <span class="math display">\[
\int_{\mathbb{R}} e^{-2V(x)} dx &lt; \infty.
\]</span></p>
<p>Proof:</p>
<p><span class="math display">\[
\begin{align}
A^*f &amp;= \frac{1}{2} \partial_x^2(\sigma^2(x) f) - \partial_x(\mu(x) f) \\
&amp;= \frac{1}{2} \partial_x^2 f - \partial_x(-V'(x) f) \\
&amp;= \frac{1}{2} \partial_x^2 f + V''(x) f + V'(x) \partial_x f.\
\end{align}
\]</span></p>
<p>If <span class="math display">\[
f(x) = C e^{-2 V(x)},
\]</span> then</p>
<p><span class="math display">\[
\begin{align}
A^* f &amp;= \frac{1}{2} \partial_x^2(C e^{-2 V(x)}) + V''(x) Ce^{-2V(x)}  - V'(x) 2 V'(x) Ce^{-2V(x)} \\
&amp;= \frac{1}{2} \partial_x(-2 V'(x) Ce^{-2V(x)}) + V''(x) f - 2 (V'(x))^2 f \\
&amp;= \frac{1}{2}( -2 V''(x) C e^{-2V(x)} + 4 (V'(x))^2 Ce^{-2V(x)}) + V''(x)f - 2(V'(x))^2 f \\
&amp;= -V''(x) f +2 (V'(x))^2 f + V''(x) f -2(V'(x))^2 f \\
&amp;= 0.
\end{align}
\]</span></p>
<p><span class="math display">\[
\qed
\]</span></p>
</section>
<section id="b-4" class="level4">
<h4 class="anchored" data-anchor-id="b-4">(b)</h4>
<p>Let <span class="math display">\[
V(x) = | x |.
\]</span> Then the SDE is</p>
<p><span class="math display">\[
d X_t = d B_t - \sgn(X_t) dt
\]</span> for <span class="math inline">\(t \geq 0\)</span>, where <span class="math display">\[
\sgn(x) = \begin{cases}
1 &amp; \text{if } x \geq 0, \\
-1&amp; \text{otherwise.}
\end{cases}
\]</span></p>
<p>In this case, the invariant distribution is of the form <span class="math display">\[
f(x) = C e^{-2|x|}.
\]</span> The constant <span class="math inline">\(C\)</span> is found from the contstraint that <span class="math inline">\(f(x)\)</span> integrated over all <span class="math inline">\(x\)</span> must be zero:</p>
<p><span class="math display">\[
\begin{align}
1 &amp;= \int_{-\infty}^{\infty} f (x) \, dx \\
&amp;= C \int_{-\infty}^{\infty} e^{-2|x|} \, dx \\
&amp;= 2C \int_0^{\infty} e^{-2x} \, dx \\
&amp;= 2C \frac{1}{2} \\
&amp;= C
\end{align}
\]</span> i.e.&nbsp;<span class="math inline">\(C = 1\)</span>.</p>
</section>
</section>
<section id="cir-model-as-a-markov-process" class="level2">
<h2 class="anchored" data-anchor-id="cir-model-as-a-markov-process">8.10 CIR Model as a Markov Process</h2>
<p><span class="math display">\[
d R_t = (a - b R_t) dt + \sigma \sqrt{R_t} dB_t
\]</span> with <span class="math inline">\(a &gt; \sigma^2/4\)</span>.</p>
<section id="a-6" class="level4">
<h4 class="anchored" data-anchor-id="a-6">(a)</h4>
<p>The generator of <span class="math inline">\((R_t, t \geq 0)\)</span> is</p>
<p><span class="math display">\[
\begin{align}
A f &amp;=  \frac{x \sigma^2}{2} \partial_x^2 f + (a - b x) \partial_x f
\end{align}
\]</span> for suitable <span class="math inline">\(f\)</span>.</p>
</section>
<section id="b-5" class="level4">
<h4 class="anchored" data-anchor-id="b-5">(b)</h4>
<p>Let <span class="math inline">\(f\)</span> be defined <span class="math display">\[
f(x) = x^{\frac{2a}{\sigma^2} - 1} e^{-\frac{2b}{\sigma^2}x}.
\]</span></p>
<p>Then <span class="math display">\[
A^* f = 0.
\]</span> Proof: Leaving the leg work to the computer:</p>
<div id="3308cf37" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sympy.abc <span class="im">import</span> x,a,b,sigma</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> fractions <span class="im">import</span> Fraction</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> display, Markdown</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> x<span class="op">**</span>((<span class="dv">2</span><span class="op">*</span>a)<span class="op">/</span>(sigma<span class="op">**</span><span class="dv">2</span>) <span class="op">-</span><span class="dv">1</span>) <span class="op">*</span> sp.exp(<span class="op">-</span>(<span class="dv">2</span><span class="op">*</span>b<span class="op">*</span>x)<span class="op">/</span>(sigma<span class="op">**</span><span class="dv">2</span>))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>adjoint_f <span class="op">=</span> Fraction(<span class="dv">1</span>, <span class="dv">2</span>) <span class="op">*</span> sp.diff(sigma<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> x<span class="op">*</span> f, x, <span class="dv">2</span>) <span class="op">-</span> sp.diff((a <span class="op">-</span> b <span class="op">*</span>x)<span class="op">*</span>f, x)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(adjoint_f.simplify() <span class="op">==</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>True</code></pre>
</div>
</div>
</section>
</section>
<section id="feynman-kac-with-terminal-value" class="level2">
<h2 class="anchored" data-anchor-id="feynman-kac-with-terminal-value">8.11 Feynman-Kac with Terminal Value</h2>
<p><span class="math display">\[
M_t = f(t, X_t) \exp\left(- \int_0^t r(X_s) ds \right)
\]</span></p>
</section>
<section id="b_t2-is-a-markov-process" class="level2">
<h2 class="anchored" data-anchor-id="b_t2-is-a-markov-process">8.12 <span class="math inline">\(B_t^2\)</span> is a Markov Process</h2>
<section id="a-7" class="level4">
<h4 class="anchored" data-anchor-id="a-7">(a)</h4>
<p><span class="math inline">\(B_t^2\)</span> is a Markov process.</p>
<p>Proof:</p>
<p>It must be shown that <span class="math display">\[
\E(B_t^2 | \F_s) = \E(B_t^2 | B_s^2)
\]</span> where <span class="math inline">\(\F_s\)</span> is the natural filtration of the process <span class="math inline">\(B_s^2\)</span>.</p>
<p>The proof will make use of the <em>Independence Lemma</em>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Independence Lemma
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\((\Omega, \F, \P)\)</span> be a probability space, and let <span class="math inline">\(\mathcal{G}\)</span> be a sub-<span class="math inline">\(\sigma\)</span>-algebra of <span class="math inline">\(\F\)</span>. Suppose the random variables <span class="math inline">\(X_1 , \ldots, X_K\)</span> are <span class="math inline">\(\mathcal{G}\)</span>-measurable and the random variables <span class="math inline">\(Y_1 , \ldots, Y_L\)</span> are independent of <span class="math inline">\(\mathcal{G}\)</span>. Let <span class="math display">\[
f ( x _1 , \ldots, X_K , y_1 , \ldots, Y_L)
\]</span> be a function of the dummy variables <span class="math inline">\(x_1 ,\ldots, X_K\)</span> and <span class="math inline">\(Y_1 , \ldots , Y_L\)</span> , and define <span class="math display">\[
g ( x_1 ,\ldots , x_K ) = \E(f ( x_1 , \ldots, x_K , Y_1 ,\ldots, Y_L)).
\]</span></p>
<p>Then <span class="math display">\[
\E(f(X_1, \ldots, X_K, Y_1, \ldots, Y_L | \mathcal{G}) = g(X_1, \ldots, X_k).
\]</span></p>
</div>
</div>
<p>The process <span class="math inline">\(B_t^2\)</span> can be expressed in terms of <span class="math inline">\(Y_1=(B_t - B_s)\)</span>, <span class="math inline">\(Y_2 = \sgn(B_s)\)</span> and <span class="math inline">\(X = B_s^2\)</span>: <span class="math display">\[
\begin{align}
B_t^2 &amp;= Y_1^2 + 2 Y_1 Y_2 \sqrt{X} + X \\
&amp;= f(Y_1, Y_2, X)
\end{align}
\]</span> where <span class="math display">\[
f(y_1, y_2, x) = y_1^2 + 2 y_1 y_2\sqrt{x} + x.
\]</span></p>
<p>Since <span class="math inline">\(\sigma(B_s^2) \subseteq \sigma(B_s)\)</span>, the independence of Brownian increments can be invoked to assert that <span class="math inline">\(Y_1\)</span> is independent of <span class="math inline">\(\F_s\)</span>.</p>
<p>Trivially, <span class="math inline">\(\sigma(|B_s|) = \sigma(B_s^2)\)</span>. Therefore, <span class="math inline">\(\sgn(B_s)\)</span> is independent of <span class="math inline">\(\F_s\)</span> if and only if <span class="math inline">\(\sgn(B_s)\)</span> is independent of <span class="math inline">\(\sigma(|B_{s'}|)\)</span> for <span class="math inline">\(s' \leq s\)</span>. Intuitively, <span class="math inline">\(\sgn(B_s)\)</span> is independent of the magnitude of <span class="math inline">\(B_s\)</span> because the magnitude gives no information about the sign, and vice versa.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>For <span class="math inline">\(s \leq t\)</span> and <span class="math inline">\(A \subseteq \mathbb{R}_+\)</span>,</p>
<p><span class="math display">\[
\P(B_s \in A, \sgn(B_t) = -1) = \P(-B_s \in A, \sgn(B_t) = 1)
\]</span> by symmetry. Then <span class="math display">\[
\begin{align}
\P(|B_s| \in A, \sgn(B_t) = 1) &amp;= \P(B_s \in A, \sgn(B_t) =1) + \P(-B_s \in A, \sgn(B_t) =1) \\
&amp;= \P(B_s \in A, \sgn(B_t) =1) + \P (B_s \in A, \sgn(B_t) = -1) \\
&amp;= \P(B_s \in A) \\
&amp;= \frac{1}{2} \P(|B_s| \in A) \\
&amp;= \P(|B_s| \in A) \P(\sgn(B_t) = 1).
\end{align}
\]</span> Similarly, <span class="math display">\[
\P(|B_s| \in A, \sgn(B_t) = -1) = \P(|B_s| \in A) \P(\sgn(B_t) = -1),
\]</span> and so <span class="math inline">\(|B_s|\)</span> and <span class="math inline">\(\sgn(B_t)\)</span> are independent</p>
</div>
</div>
<p>The random variable <span class="math inline">\(X = B_s^2\)</span> is obviously <span class="math inline">\(\F_s\)</span>-measurable.</p>
<p>These facts taken together allow the Independence Lemma to be applied giving</p>
<p><span class="math display">\[
\begin{align}
\E(B_t^2 | \F_s) &amp;= g(B_s^2).
\end{align}
\]</span></p>
<p>The random variable <span class="math inline">\(g(B_s^2)\)</span> is <span class="math inline">\(\sigma(B_s^2)\)</span>-measurable and satisifies <span class="math display">\[
\begin{align}
\int_A g(B_s^2) d \P &amp;= \int_A \E(B_t^2 | \F_s) d \P \\
&amp;= \int_A B_t^2 d \P
\end{align}
\]</span> for all <span class="math inline">\(A \in \sigma(B_s^2) \subseteq \F_s\)</span> i.e. <span class="math display">\[
g(B_s^2) = \E(B_t^2 | B_s^2).
\]</span></p>
<p><span class="math display">\[
\qed
\]</span></p>
</section>
<section id="b-6" class="level4">
<h4 class="anchored" data-anchor-id="b-6">(b)</h4>
<p><span class="math display">\[
\int_0^t B_s dB_s
\]</span> is a Markov process.</p>
<p>Proof:</p>
<p>Using Itoâ€™s formula</p>
<p><span class="math display">\[
B_t^2 = 2 \int_0^t B_s d B_s + t
\]</span> and so <span class="math display">\[
X_t = \int_0^t B_s d B_s = \frac{1}{2} (B_t^2 - t).
\]</span></p>
<p>The process <span class="math inline">\(X_t\)</span> is Markov:</p>
<p><span class="math display">\[
\begin{align}
\E(X_t | \F_s) &amp;= \frac{1}{2}\left(\E(B_t^2 | \F_s) - t \right) \\
&amp;= \frac{1}{2} \left(\E(B_t^2 | B_s^2) -t \right) \\
&amp;= \E(X_t | B_s^2) \\
&amp;= \E(X_t | X_s).
\end{align}
\]</span></p>
<p><span class="math display">\[
\qed
\]</span></p>
</section>
</section>
<section id="generator-of-a-poisson-process" class="level2">
<h2 class="anchored" data-anchor-id="generator-of-a-poisson-process">8.13 Generator of a Poisson Process</h2>
<p>Let <span class="math inline">\((N_t, t \geq 0)\)</span> be a Poisson process with rate <span class="math inline">\(\lambda\)</span>.</p>
<section id="a-8" class="level4">
<h4 class="anchored" data-anchor-id="a-8">(a)</h4>
<p><span class="math inline">\((N_t, t \geq 0)\)</span> is a Markov process.</p>
<p>Proof:</p>
<p>Let <span class="math inline">\((F_s, s \geq 0\)</span>) the the natural filtration of the process. The increments of the process are independent: in particular, <span class="math inline">\(N_t - N_s\)</span> is independent of <span class="math inline">\(\F_s\)</span> and <span class="math inline">\(\sigma(N_s)\)</span>. For <span class="math inline">\(s \leq t\)</span>,</p>
<p><span class="math display">\[
\begin{align}
\E(N_t , \F_s) &amp;= E(N_t - N_s + N_s | \F_s) \\
&amp;= \E(\underbrace{N_t - N_s}_{\text{independent of $\F_s$}} | \F_s) + \E(\underbrace{N_s}_{\F_s\text{-measurable}} | \F_s) \\
&amp;= \E(N_t - N_s) + N_s \\
&amp;= \E(N_t - N_s| N_s) + N_s \\
&amp;= \E(N_t | N_s).
\end{align}
\]</span></p>
<p><span class="math display">\[
\qed
\]</span></p>
</section>
<section id="b-7" class="level4">
<h4 class="anchored" data-anchor-id="b-7">(b)</h4>
<p>The generator of the Poisson process is <span class="math display">\[
A f = \lambda (f (x+1) - f(x)).
\]</span></p>
<p>Proof:</p>
<p>Let <span class="math inline">\(h\)</span> be some arbitrary function with support inside a finite interval.</p>
<p><span class="math display">\[
\begin{align}
\frac{1}{\varepsilon}\E(h(N_{t + \varepsilon})- h(N_t)) &amp;= \frac{1}{\varepsilon} \sum h(k) \left(\frac{\lambda^k(t+ \varepsilon)^k  e^{-\lambda (t + \varepsilon)}}{k!} - \frac{\lambda^kt^k e^{-\lambda t}}{k!}\right) \\
&amp;= \frac{1}{\varepsilon} \sum \frac{h(k)\lambda^k e^{-\lambda t}}{k!} \left( e^{-\lambda \varepsilon}\sum_{n = 0}^k {k \choose n} t^{k - n} \varepsilon^{n}  - t^k\right) \\
&amp;= \frac{1}{\varepsilon} \sum \frac{h(k)\lambda^k e^{-\lambda t}}{k!} \left( e^{-\lambda \varepsilon}\sum_{n = 1}^k {k \choose n} t^{k -n }\varepsilon^{n} + t^k (e^{-\lambda\varepsilon} - 1)  \right) \\
&amp;= \sum \frac{h(k)\lambda^k e^{-\lambda t}}{k!} \left( e^{-\lambda \varepsilon}\sum_{n = 1}^k {k \choose n} t^{k -n }\varepsilon^{n-1} + t^k\underbrace{\frac{e^{-\lambda \varepsilon} -1 }{\varepsilon}}_{\to \frac{d e^{-\lambda x}}{dx} \vert_{x=0}}  \right) \\
&amp;\to \sum \frac{h(k) \lambda^k e^{-\lambda t}}{k!} (k t^{k-1} - \lambda t^k)  \\
&amp;= \lambda\left (\E((Th)(N_t)) - \E(h(N_t))\right)
\end{align}
\]</span></p>
<p>where <span class="math display">\[
(Th)(x) = h(x+1).
\]</span></p>
<p>Therefore,</p>
<p><span class="math display">\[
\partial_t f(x) = \lambda(f(x + 1) - f(x))
\]</span> with limit in the <span class="math inline">\(L^2(\Omega, \F, \P)\)</span> sense. <span class="math display">\[
\qed
\]</span></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/stevenjohnstone\.github\.io\/learn-relearn\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>