<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="description" content="Solutions to exercises and computer experiments">

<title>learn-relearn - Exercises</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">learn-relearn</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-first-course-in-stochastic-calculus" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">First Course in Stochastic Calculus</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-first-course-in-stochastic-calculus">    
        <li class="dropdown-header">First Course in Stochastic Calculus</li>
        <li>
    <a class="dropdown-item" href="../../FCSC/ch1/ch1_experiments.html">
 <span class="dropdown-text">Chapter 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../FCSC/ch2/ch2_experiments.html">
 <span class="dropdown-text">Chapter 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../FCSC/ch3/ch3_experiments.html">
 <span class="dropdown-text">Chapter 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../FCSC/ch4/ch4_experiments.html">
 <span class="dropdown-text">Chapter 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../FCSC/ch5/ch5_experiments.html">
 <span class="dropdown-text">Chapter 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../FCSC/ch6/ch6_experiments.html">
 <span class="dropdown-text">Chapter 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../FCSC/ch7/ch7_experiments.html">
 <span class="dropdown-text">Chapter 7</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-probabilistic-machine-learning" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Probabilistic Machine Learning</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-probabilistic-machine-learning">    
        <li class="dropdown-header">Probabilistic Machine Learning</li>
        <li>
    <a class="dropdown-item" href="../../PML/ch2.html">
 <span class="dropdown-text">Probabilistic Machine Learning</span></a>
  </li>  
    </ul>
  </li>
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Exercises</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">First Course in Stochastic Calculus</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Chapter 1</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch1/ch1_experiments.html" class="sidebar-item-text sidebar-link">Computer Experiments</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch1/ch1_exercises.html" class="sidebar-item-text sidebar-link">Exercises</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Chapter 2</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch2/ch2_experiments.html" class="sidebar-item-text sidebar-link">Computer Experiments</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch2/ch2_exercises.html" class="sidebar-item-text sidebar-link">Exercises</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">Chapter 3</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch3/ch3_experiments.html" class="sidebar-item-text sidebar-link">Computer Experiments</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch3/ch3_exercises.html" class="sidebar-item-text sidebar-link">Exercises</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">Chapter 4</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch4/ch4_experiments.html" class="sidebar-item-text sidebar-link">Computer Experiments</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch4/ch4_exercises.html" class="sidebar-item-text sidebar-link">Exercises</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">Chapter 5</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch5/ch5_experiments.html" class="sidebar-item-text sidebar-link">Computer Experiments</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch5/ch5_exercises.html" class="sidebar-item-text sidebar-link">Exercises</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">Chapter 6</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch6/ch6_experiments.html" class="sidebar-item-text sidebar-link">Computer Experiments</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch6/ch6_exercises.html" class="sidebar-item-text sidebar-link">Exercises</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">Chapter 7</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch7/ch7_experiments.html" class="sidebar-item-text sidebar-link">Computer Experiments</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../FCSC/ch7/ch7_exercises.html" class="sidebar-item-text sidebar-link active">Exercises</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Exercises</h1>
</div>

<div>
  <div class="description">
    Solutions to exercises and computer experiments
  </div>
</div>


<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>
<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#sde-of-brownian-bridge" id="toc-sde-of-brownian-bridge">7.1 SDE of Brownian Bridge</a></li>
  <li><a href="#ornstein-uhlenbeck-process-with-parameters" id="toc-ornstein-uhlenbeck-process-with-parameters">7.2 Ornstein-Uhlenbeck Process with Parameters</a></li>
  <li><a href="#generalized-geometric-brownian-motion" id="toc-generalized-geometric-brownian-motion">7.3 Generalized Geometric Brownian Motion</a></li>
  <li><a href="#a-covariance-process" id="toc-a-covariance-process">7.4 A Covariance Process</a></li>
  <li><a href="#practice-on-product-rule" id="toc-practice-on-product-rule">7.5 Practice on Product Rule</a></li>
  <li><a href="#review-of-itô-integrals" id="toc-review-of-itô-integrals">7.6 Review of Itô Integrals</a></li>
  <li><a href="#exercise-on-stochastic-calculus" id="toc-exercise-on-stochastic-calculus">7.7 Exercise on Stochastic Calculus</a></li>
  <li><a href="#an-exercise-on-the-cir-model" id="toc-an-exercise-on-the-cir-model">7.8 An Exercise on the CIR Model</a></li>
  <li><a href="#solving-an-sde" id="toc-solving-an-sde">7.9 Solving an SDE</a></li>
  <li><a href="#practice-on-sdes" id="toc-practice-on-sdes">7.10 Practice on SDEs</a></li>
  <li><a href="#applications-of-lévys-characterisation" id="toc-applications-of-lévys-characterisation">7.11 Applications of Lévy’s Characterisation</a></li>
  <li><a href="#sde-of-the-bessel-process" id="toc-sde-of-the-bessel-process">7.12 SDE of the Bessel Process</a></li>
  <li><a href="#conditional-itô-isometry" id="toc-conditional-itô-isometry">7.13 Conditional Itô Isometry</a></li>
  </ul>
</nav>
<div class="hidden">
<p><span class="math display">\[
\newcommand{\Cov}{\operatorname{Cov}}
\newcommand{\Var}{\operatorname{Var}}
\newcommand{\E}{\operatorname{E}}
\newcommand{\P}{\operatorname{P}}
\newcommand{\rank}{\operatorname{rank}}
\newcommand{\trace}{\operatorname{trace}}
\newcommand{\sgn}{\operatorname{sgn}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\G}{\mathcal{G}}
\newcommand{\qed}{\tag*{$\square$}}
\newcommand{\erf}{\operatorname{erf}}
\def\iddots{{\kern3mu\raise1mu{.}\kern3mu\raise6mu{.}\kern3mu
\raise12mu{.}}}
\]</span></p>
</div>
<section id="sde-of-brownian-bridge" class="level2">
<h2 class="anchored" data-anchor-id="sde-of-brownian-bridge">7.1 SDE of Brownian Bridge</h2>
<p><span class="math inline">\(Z_0 = Z_1 = 0\)</span> and <span class="math display">\[
\begin{align}
Z_t = (1-t) \int_0^t \frac{d B_s}{1 - s}, &amp;&amp; 0 &lt; t &lt; 1.
\end{align}
\]</span></p>
<p><span class="math inline">\(Z_t\)</span> satisfies the SDE</p>
<p><span class="math display">\[
d Z_t = d B_t - \frac{Z_t}{1-t} dt.
\]</span></p>
<p>Proof:</p>
<p><span class="math inline">\(Z_t\)</span> is an explicit function of <span class="math inline">\(t\)</span> and of the Itô process</p>
<p><span class="math display">\[
X_t = \int_0^t \frac{d B_s}{1 -s}.
\]</span> That is,</p>
<p><span class="math display">\[
Z_t = f(t, X_t)
\]</span> where <span class="math display">\[
f(t, x) = (1 - t) x.
\]</span></p>
<p>Now,</p>
<p><span class="math display">\[
d X_t = \frac{1}{1-t} d B_t
\]</span> so <span class="math display">\[
V_t = \frac{1}{1-t},
\]</span> and <span class="math display">\[
D_t = 0.
\]</span></p>
<p>Using Itô’s formula for Itô processes <span class="math display">\[
\begin{align}
d Z_t &amp;= \partial_1 f(t, X_t)V_t d B_t + \left( \partial_0 f(t, X_t) + \frac{V_t^2}{2} \partial_1^2 f(t, X_t) + D_t \partial_1 f(t, X_t)\right) dt \\
&amp;= (1 - t) V_t d B_t + \left( -X_t + (1-t) D_t \right)dt \\
&amp;= d B_t - X_t dt \\
&amp;= d B_t - \frac{Z_t}{1-t} dt.
\end{align}
\]</span> <span class="math display">\[
\qed
\]</span></p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The local drift acts to force the motion towards the x-axis with a force which increases with the distance from the axis and increasing as time tends to zero.</p>
</div>
</div>
</section>
<section id="ornstein-uhlenbeck-process-with-parameters" class="level2">
<h2 class="anchored" data-anchor-id="ornstein-uhlenbeck-process-with-parameters">7.2 Ornstein-Uhlenbeck Process with Parameters</h2>
<p>The solution of the SDE <span class="math display">\[
\begin{align}
d Y_t = -k Y_t dt + \sigma d B_t, &amp;&amp; k\in \mathbb{R}, \sigma &gt; 0
\end{align}
\]</span> is <span class="math display">\[
Y_t = Y_0 e^{-kt} + e^{-kt} \int_0^t e^{ks} \sigma dB_s.
\]</span></p>
<p>Proof:</p>
<p><span class="math inline">\(Y_t\)</span> is an explicit function of <span class="math inline">\(t\)</span> and an Itô process <span class="math inline">\(X_t\)</span> given by <span class="math display">\[
X_t = Y_0 + \int_0^t e^{ks} \sigma d B_s.
\]</span> <span class="math inline">\(X_t\)</span> is a diffusion with drift <span class="math display">\[
D_t = 0,
\]</span> and volatility <span class="math display">\[
V_t = e^{kt} \sigma.
\]</span> In fact, defining <span class="math display">\[
f(t, x) = e^{-kt} x
\]</span> we have <span class="math display">\[
Y_t = f(t, X_t).
\]</span></p>
<p>Using Itô’s formula for Itô processes, we see that <span class="math display">\[
\begin{align}
d f(t, X_t) &amp;= e^{-kt} e^{kt} \sigma d B_t -ke^{kt} \sigma dt \\
&amp;= \sigma d B_t - k Y_t dt.
\end{align}
\]</span></p>
<p>The proof is complete by noting that</p>
<p><span class="math display">\[
d f(t, X_t) = f(t, X_t) - f(0, X_0) = Y_t - Y_0.
\]</span> <span class="math display">\[\qed\]</span></p>
</section>
<section id="generalized-geometric-brownian-motion" class="level2">
<h2 class="anchored" data-anchor-id="generalized-geometric-brownian-motion">7.3 Generalized Geometric Brownian Motion</h2>
<p>The process <span class="math inline">\((M_t)\)</span> defined by <span class="math display">\[
\begin{align}
M_t = \exp\left(\int_0^t \sigma(s) dB_s - \frac{1}{2} \int_0^t \sigma^2(s) ds\right), &amp;&amp; t \leq T
\end{align}
\]</span> is a Martingale for the Brownian filtration, whenever <span class="math display">\[
\int_0^T \sigma^2(t) dt &lt; \infty.
\]</span></p>
<p>Proof:</p>
<p>We can express <span class="math inline">\(M_t\)</span> in terms of a Wiener integral</p>
<p><span class="math display">\[
X_t = \int_0^t \sigma(s) d B_s.
\]</span></p>
<p>Since <span class="math display">\[
\int_0^T \sigma^2(t) dt &lt; \infty
\]</span> the process <span class="math inline">\((X_t, t \in[0, T])\)</span> is Gaussian with mean zero and variance <span class="math display">\[
\E(X_t^2) = \int_0^t \sigma^2(s) ds.
\]</span></p>
<p>We write <span class="math display">\[
\begin{align}
\E(M_t | \F_s) &amp; = \E(M_s \exp(X_t - X_s - \frac{1}{2}\int_s^t \sigma^2(u) du)) | \F_s) \\
&amp;= \exp(-\frac{1}{2}\int_s^t \sigma^2(u) du) M_s \E(\exp(X_t -X_s)|\F_s)
\end{align}
\]</span> and so if we can show that <span class="math display">\[
\E(\exp(X_t - X_s) | \F_s) = \exp(\frac{1}{2}\int_s^t \sigma^2(u) du),
\]</span> then the proof is complete.</p>
<p>Suppose that <span class="math inline">\(\sigma\)</span> is a simple function. Then the random variable <span class="math inline">\(X_t - X_s\)</span> is a sum of Brownian increments independent of <span class="math inline">\(\F_s\)</span> and so <span class="math inline">\(X_t - X_s\)</span> is independent of <span class="math inline">\(\F_s\)</span>. It follows that <span class="math inline">\(\exp(X_t - X_s)\)</span> is independent of <span class="math inline">\(\F_s\)</span> and so</p>
<p><span class="math display">\[
\E(\exp(X_t - X_s) | \F_s) = \E(\exp(X_t - X_s)).
\]</span></p>
<p><span class="math inline">\(X_t - X_s\)</span> is Gaussian with mean zero and variance</p>
<p><span class="math display">\[
\begin{align}
\E((X_t - X_s)^2) &amp;= \E(X_t^2) + \E(X_s^2) - 2\E(X_s X_t) \\
&amp;= \int_0^t \sigma^2(u) du + \int_0^s \sigma^2(u) du - 2 \int_0^s \sigma^2(u) du \\
&amp;= \int_s^t \sigma^2(u) du.
\end{align}
\]</span> The expectation of the moment generating function of such a Gaussian is <span class="math display">\[
\E(\exp(X_t - X_s)) = \exp(\frac{1}{2} \int_s^t \sigma^2(u) du).
\]</span></p>
<p>Now, suppose that <span class="math inline">\(\sigma\)</span> is non-negative and measurable. It can be approximated by a non-decreasing sequence of simple functions <span class="math inline">\(\sigma_n\)</span> such that <span class="math inline">\(\sigma_n \leq \sigma\)</span>. Denote by <span class="math inline">\(X_t^{(n)}\)</span> the process corresponding to <span class="math inline">\(\sigma_n\)</span>. For <span class="math inline">\(A \in \F_s\)</span></p>
<p><span class="math display">\[
\begin{align}
\lim_{n\to\infty} \int_A \E(X_t^{(n)} - X_s^{(n)} | \F_s) dP &amp;= \lim_{n\to \infty} \exp(-\frac{1}{2}\int_s^t \sigma_n^2(u) du) \P(A) \\
&amp;= \exp(-\frac{1}{2} \int_s^t \sigma^2(u) du) \P(A)
\end{align}
\]</span> using the continuity of <span class="math inline">\(\exp\)</span> and the dominated convergence theorem to take the limit inside the integral. In addition,</p>
<p><span class="math display">\[
\begin{align}
\int_A \exp(X_t - X_s) dP &amp;= \int_A \lim_{n\to \infty} \exp(X_t^{(n)} - X_s^{(n)}) dP \\
&amp;= \lim_{n\to\infty} \int_A \exp(X_t^{(n)} - X_s^{(n)}) dP \\
&amp;= \exp(-\frac{1}{2} \int_s^t \sigma^2(u) du) \P(A),
\end{align}
\]</span> again, using dominated convergence. That is, for <span class="math inline">\(A \in \F_s\)</span>, <span class="math display">\[
\int_A \exp(\frac{1}{2} \int_s^t \sigma^2(u) du) dP = \int_A \exp(X_t - X_s) dP
\]</span> and so <span class="math display">\[
\E(\exp(X_t - X_s)|\F_s) = \exp(\frac{1}{2} \int_s^t \sigma^2(u) du).
\]</span></p>
<p>For general, measurable <span class="math inline">\(\sigma\)</span> we split the function into postive and negative parts, <span class="math inline">\(\sigma_+\)</span> and <span class="math inline">\(\sigma_-\)</span>, respectively i.e. <span class="math display">\[
\sigma = \sigma_+ - \sigma_-.
\]</span> <span class="math display">\[
\qed
\]</span></p>
</section>
<section id="a-covariance-process" class="level2">
<h2 class="anchored" data-anchor-id="a-covariance-process">7.4 A Covariance Process</h2>
<p>Let $$ <span class="math display">\[\begin{align}
X_t = \int_0^t (1 - s) d B_s, &amp;&amp; Y_t = \int_0^t (1 + s) d B_s.
\end{align}\]</span> The covariance process <span class="math inline">\((X_t Y_t, t \geq 0)\)</span> is not a martingale.</p>
<p>Proof:</p>
<p><span class="math inline">\(X_t\)</span> is an Itô process with volatility <span class="math inline">\((1-t)\)</span> and zero drift; <span class="math inline">\(Y_t\)</span> is an Itô process with volatility <span class="math inline">\((1+t)\)</span> and zero drift. Using the multivariate Itô formula with <span class="math display">\[
f(x, y) = xy
\]</span> gives <span class="math display">\[
\begin{align}
X_t Y_t &amp;= Y_t dX_t + X_t dY_t + (1-t)(1+t) dt.
\end{align}
\]</span></p>
<p>The <span class="math inline">\(dt\)</span> term is non-zero, so <span class="math inline">\(X_t Y_t\)</span> cannot be a martingale.</p>
<p><span class="math display">\[
\qed
\]</span></p>
</section>
<section id="practice-on-product-rule" class="level2">
<h2 class="anchored" data-anchor-id="practice-on-product-rule">7.5 Practice on Product Rule</h2>
<p>Let <span class="math display">\[
X_t = \int_0^t (1 - 2s) d B_s
\]</span> for <span class="math inline">\(t \geq 0\)</span>.</p>
<section id="a" class="level4">
<h4 class="anchored" data-anchor-id="a">(a)</h4>
<p><span class="math inline">\(X_t\)</span> is a Wiener intergral, so the process is Gaussian with mean zero and variance <span class="math display">\[
\begin{align}
\E(X_t^2) &amp;= \int_0^t (1 - 2s)^2 ds \\
&amp;= t - 2t^2 + \frac{4}{3} t^3 \\
\end{align}
\]</span></p>
</section>
<section id="b" class="level4">
<h4 class="anchored" data-anchor-id="b">(b)</h4>
<p>Using Itô’s product rule</p>
<p><span class="math display">\[
\begin{align}
d(X_t B_t) &amp;= X_t dB_t + B_t dX_t + (1 - 2t) dt \\
&amp;= X_t dB_t + B_t (1 - 2t) dB_t + (1 - 2t) dt
\end{align}
\]</span> or in integral form <span class="math display">\[
X_t B_t  = \int_0^t X_s dB_s + \int_0^t (1 - 2s) B_s d B_s + \int_0^t (1 - 2s) ds.
\]</span></p>
</section>
<section id="c" class="level4">
<h4 class="anchored" data-anchor-id="c">(c)</h4>
<p>When <span class="math inline">\(X_t\)</span> and <span class="math inline">\(B_t\)</span> are uncorrelated,</p>
<p><span class="math display">\[
\E(X_t B_t) = 0.
\]</span></p>
<p>From (c), this is when</p>
<p><span class="math display">\[
\E(\int_0^t X_s d B_s) + \E(\int_0^t (1 - 2s) B_s d B_s) + \E(\int_0^t (1 - 2s) ds) = 0.
\]</span></p>
<p>Since the first two terms of the LHS are zero, this reduces to finding <span class="math inline">\(t\)</span> such that</p>
<p><span class="math display">\[
t - t^2  = 0.
\]</span> That is, <span class="math inline">\(X_t\)</span> and <span class="math inline">\(B_t\)</span> are uncorrelated at <span class="math inline">\(t = 0\)</span> and <span class="math inline">\(t =1\)</span>.</p>
</section>
<section id="d" class="level4">
<h4 class="anchored" data-anchor-id="d">(d)</h4>
<p><span class="math inline">\((X_1, B_1)\)</span> are jointly Gaussian.</p>
<p>Proof:</p>
<p>For <span class="math inline">\(\alpha, \beta \in \mathbb{R}\)</span></p>
<p><span class="math display">\[
\begin{align}
\alpha X_1 + \beta B_1 &amp;= \alpha \int_0^1 (1 - 2s) d B_s + \beta \int_0^1 dB_s \\
&amp;= \int_0^1 (\alpha(1-2s) + \beta) d B_s.
\end{align}
\]</span> So, the linear combination is a Wiener integral and so is Gaussian.</p>
<p><span class="math display">\[
\qed
\]</span></p>
</section>
<section id="e" class="level4">
<h4 class="anchored" data-anchor-id="e">(e)</h4>
<p><span class="math inline">\(X_1\)</span> and <span class="math inline">\(B_1\)</span> are independent.</p>
<p>Proof:</p>
<p><span class="math inline">\(X_1\)</span> and <span class="math inline">\(B_1\)</span> are jointly Gaussian and uncorrelated and are thus independent.</p>
<p><span class="math display">\[
\qed
\]</span></p>
</section>
</section>
<section id="review-of-itô-integrals" class="level2">
<h2 class="anchored" data-anchor-id="review-of-itô-integrals">7.6 Review of Itô Integrals</h2>
<p>Let <span class="math inline">\((B_t, t \in [0, 1])\)</span> be a standard Brownian motion. Define on <span class="math inline">\([0,1]\)</span> <span class="math display">\[
\begin{align}
X_t = \int_0^t B_s ds, &amp;&amp; Y_t = \int_0^t s dB_s.
\end{align}
\]</span></p>
<section id="a-1" class="level4">
<h4 class="anchored" data-anchor-id="a-1">(a)</h4>
<p><span class="math inline">\(Y_t\)</span> is a Gaussian process with mean zero and variance <span class="math display">\[
\begin{align}
\E(Y_t^2) &amp;= \int_0^t s^2 ds \\
&amp;= \frac{t^3}{3}.
\end{align}
\]</span></p>
</section>
<section id="b-1" class="level4">
<h4 class="anchored" data-anchor-id="b-1">(b)</h4>
<p>Using the Itô isometry</p>
<p><span class="math display">\[
\begin{align}
\E(B_t Y_t) &amp;= \int_0^t s ds \\
&amp;= \frac{t^2}{2}.
\end{align}
\]</span></p>
</section>
<section id="c-1" class="level4">
<h4 class="anchored" data-anchor-id="c-1">(c)</h4>
<p>Using Itô’s product rule (and the fact that <span class="math inline">\(X_t\)</span> has zero volatility)</p>
<p><span class="math display">\[
\begin{align}
d(X_t Y_t) &amp;= X_t dY_t + Y_t dX_t \\
&amp;= X_t t dB_t + Y_t B_t dt.
\end{align}
\]</span></p>
<p>Then</p>
<p><span class="math display">\[
\begin{align}
\E(X_t Y_t) &amp;= \E(\int_0^t X_s s dB_s) + \E(\int_0^t Y_s B_s ds) \\
&amp;= \int_0^t \E(Y_s B_s) ds \\
&amp;= \int_0^t s^2/2 ds \\
&amp;= \frac{t^3}{6}.
\end{align}
\]</span></p>
</section>
<section id="d-1" class="level4">
<h4 class="anchored" data-anchor-id="d-1">(d)</h4>
<p><span class="math display">\[
\begin{align}
\rho(X_1, Y_1) &amp;= \frac{\E(X_1 Y_1)}{\underbrace{\sqrt{\E(X_1^2)}}_{\text{use Fubini's theorem}}\sqrt{\E(Y_1^2)}} \\
&amp;= \frac{1/6}{\sqrt{(1/3)(1/3)}} \\
&amp;= \frac{1}{2}.
\end{align}
\]</span></p>
</section>
</section>
<section id="exercise-on-stochastic-calculus" class="level2">
<h2 class="anchored" data-anchor-id="exercise-on-stochastic-calculus">7.7 Exercise on Stochastic Calculus</h2>
<p>Let <span class="math display">\[
\begin{align}
Y_t = e^t dB_t, &amp;&amp; Y_0 = 0.
\end{align}
\]</span></p>
<p>Let <span class="math display">\[
\tau = \min_{t \geq 0} \{ Y_t = 1 \text{ or } Y_t = -1\}.
\]</span></p>
<p>Then</p>
<p><span class="math display">\[
\E(\tau) \leq \log(3)/2.
\]</span></p>
<p>Proof:</p>
<section id="a-2" class="level4">
<h4 class="anchored" data-anchor-id="a-2">(a)</h4>
<p>Find a PDE for <span class="math inline">\(f(t, x)\)</span> satisfied whenever <span class="math inline">\(f(t, Y_t)\)</span> is a martingale.</p>
<p><span class="math display">\[
\begin{align}
df(t, Y_t) &amp;= \partial_1 f(t, Y_t) e^t dB_t + \left( \partial_0 f(t, Y_t) + \frac{e^{2t}}{2} \partial_1^2 f(t, Y_t)\right) dt \\
\end{align}
\]</span> and so <span class="math inline">\(f(t, Y_t)\)</span> is a martingale when</p>
<p><span class="math display">\[
\partial_0 f(t, x) + \frac{e^{2t}}{2} \partial_1^2 f(t, x) = 0.
\]</span></p>
</section>
<section id="b-2" class="level4">
<h4 class="anchored" data-anchor-id="b-2">(b)</h4>
<p><span class="math display">\[
f(t, x) = x^2 - \frac{e^{2t}}{2}
\]</span> satisfies the PDE:</p>
<p><span class="math display">\[
\begin{align}
\partial_0 (x^2 - \frac{e^{2t}}{2}) + \frac{e^{2t}}{2} \partial_1^2(x^2 - \frac{e^{2t}}{2}) &amp;= \\
-e^{2t} + e^{2t} &amp;= \\
0.
\end{align}
\]</span></p>
<p>Then <span class="math display">\[
Y_t^2 - \frac{e^{2t}}{2} = \int_0^t B_s e^s d B_s - 1/2.
\]</span></p>
</section>
<section id="c-2" class="level4">
<h4 class="anchored" data-anchor-id="c-2">(c)</h4>
<p><span class="math inline">\(\tau\)</span> is a stopping time. The stopped process <span class="math inline">\(Y^2_{\tau \wedge t} - \frac{e^{2(\tau \wedge t)}}{2}\)</span> is a martingale and</p>
<p><span class="math display">\[
\begin{align}
\E(Y^2_{\tau \wedge t} - \frac{e^{2(\tau \wedge t)}}{2})  &amp;= E(Y^2_{0} - 1/2) \\
&amp;= -1/2.
\end{align}
\]</span></p>
<p>By the dominated convergence theorem</p>
<p><span class="math display">\[
\lim_{t \to \infty} E(Y^2_{\tau \wedge t}) = \E(Y^2_{\tau}) = 1.
\]</span></p>
<p>Using the continuity of the exponential and the monotone convergence theorem</p>
<p><span class="math display">\[
\lim_{t \to \infty} \E(e^{2(\tau \wedge t)}) = \lim_{t \to \infty} \E(e^{2(\tau \wedge t)}) = \E(e^{2\tau}).
\]</span> Therefore,</p>
<p><span class="math display">\[
1 - \E(\frac{e^{2\tau}}{2}) = -1/2
\]</span> and so</p>
<p><span class="math display">\[
\E(e^{2 \tau}) = 3.
\]</span></p>
</section>
<section id="d-2" class="level4">
<h4 class="anchored" data-anchor-id="d-2">(d)</h4>
<p>Using Jensen’s inequality,</p>
<p><span class="math display">\[
\exp(\E(2\tau)) \leq \E(e^{2 \tau}) = 3.
\]</span> Therefore,</p>
<div class="cell" data-execution_count="1">
<div class="cell-output cell-output-display">
<p><span class="math display">\[\E(\tau) \leq \log(3)/2 \approx 0.5493061443340549\]</span></p>
</div>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Appears to be a mistake in the question. We are asked to show that <span class="math display">\[
\E(\tau) \leq 0.347\ldots
\]</span> which would mean showing that <span class="math display">\[
\E(\tau) \leq \log(2)/2.
\]</span></p>
</div>
</div>
</section>
</section>
<section id="an-exercise-on-the-cir-model" class="level2">
<h2 class="anchored" data-anchor-id="an-exercise-on-the-cir-model">7.8 An Exercise on the CIR Model</h2>
<p>Let <span class="math display">\[
\begin{align}
d X_t = \frac{1}{2} dt + \sqrt{X_t} d B_t, &amp;&amp; X_0 = 1.
\end{align}
\]</span></p>
<section id="a-3" class="level4">
<h4 class="anchored" data-anchor-id="a-3">(a)</h4>
<p><span class="math display">\[
\begin{align}
df(t, X_t) &amp;= \partial_1 f(t, X_t) \sqrt{X_t} d B_t + \left(\partial_0 f(t, X_t) + \frac{X_t}{2} \partial_1^2 f(t, X_t) + \frac{1}{2} \partial_1 f(t, X_t)\right) dt.
\end{align}
\]</span></p>
</section>
<section id="b-3" class="level4">
<h4 class="anchored" data-anchor-id="b-3">(b)</h4>
<p><span class="math inline">\(f(t, X_t)\)</span> is a martingale when</p>
<p><span class="math display">\[
\partial_0 f(t, x) + \frac{x}{2} \partial_1^2 f(t, x) + \frac{1}{2}\partial_1 f(t, x) = 0.
\]</span></p>
</section>
<section id="c-3" class="level4">
<h4 class="anchored" data-anchor-id="c-3">(c)</h4>
<p><span class="math inline">\(\log(X_t)\)</span> and <span class="math inline">\(t - 2 X_t\)</span> are martingales because <span class="math inline">\(\log(x)\)</span> and <span class="math inline">\(t - 2x\)</span> satisfy the PDE.</p>
</section>
<section id="d-3" class="level4">
<h4 class="anchored" data-anchor-id="d-3">(d)</h4>
<p>Let</p>
<p><span class="math display">\[
\tau = \min_{t \geq 0} \{ X_t = e \text{ or } X_t = e^{-1} \}.
\]</span></p>
<p><span class="math inline">\(\tau\)</span> is a stopping time. The stopped process <span class="math inline">\(\log(X_{\tau \wedge t})\)</span> is a martingale and <span class="math display">\[
\E(\log(X_{\tau \wedge t})) = \E(\log(1)) = 0.
\]</span></p>
<p>Using the monotone convergence theorem</p>
<p><span class="math display">\[
\lim_{t \to \infty} \E(\log(X_{\tau \wedge t})) = \E(\log(X_{\tau})) = 0.
\]</span></p>
<p>Since <span class="math inline">\(X_{\tau}\)</span> takes only two values <span class="math display">\[
\begin{align}
\E(\log(X_{\tau})) &amp;=  \log(e) \P(X_{\tau} = e) + \log(e^{-1}) (1 - \P(X_{\tau} = e)) \\
&amp;= 2 \P(X_{\tau} = e) - 1 \\
&amp;= 0
\end{align}
\]</span> i.e. <span class="math display">\[
\P(X_{\tau} = e) = \frac{1}{2}.
\]</span></p>
</section>
<section id="e-1" class="level4">
<h4 class="anchored" data-anchor-id="e-1">(e)</h4>
<p><span class="math inline">\(t - 2 X_t\)</span> is a martingale and so the stopped process</p>
<p><span class="math display">\[
t \wedge \tau - 2 X_{\tau \wedge t}
\]</span> is also a martingale. In particular,</p>
<p><span class="math display">\[
\E(\tau \wedge t - 2 X_{\tau \wedge t}) = -2.
\]</span></p>
<p>Taking the limit as <span class="math inline">\(t \to \infty\)</span> and using the monotime convergence theorem <span class="math display">\[
\lim_{t \to \infty} \E(\tau \wedge t) = \E(\tau).
\]</span> The process <span class="math inline">\(X_{\tau \wedge t}\)</span> is bounded by <span class="math inline">\(e\)</span>, so the dominated convergence theorem gives <span class="math display">\[
\lim_{t \to \infty} \E(X_{\tau \wedge t}) = \E(X_{\tau}).
\]</span> Therefore, <span class="math display">\[
\E(\tau) = 2\E(X_{\tau}) - 2.
\]</span> <span class="math inline">\(X_{\tau}\)</span> takes only two values, therefore</p>
<p><span class="math display">\[
\begin{align}
\E(\tau) &amp;= 2 (\P(X_{\tau} = e) e - (1 - \P(X_{\tau} = e)) e^{-1})) - 2 \\
&amp;= e- e^{-1} - 2 \\
&amp;= 2 \sinh(1) - 2.
\end{align}
\]</span></p>
</section>
</section>
<section id="solving-an-sde" class="level2">
<h2 class="anchored" data-anchor-id="solving-an-sde">7.9 Solving an SDE</h2>
<p>Let <span class="math display">\[
\begin{align}
d X_t = -\frac{X_t}{2 -t}dt + \sqrt{t (2 -t)} d B_t,&amp;&amp; 0 \leq t &lt; 1, &amp;&amp; X_0 = 0.
\end{align}
\]</span></p>
<p>Suppose the solution is of the form</p>
<p><span class="math display">\[
\begin{align}
X_t = a(t) Y_t, &amp;&amp; Y_t = \int_0^t b(s) dB_s,
\end{align}
\]</span> for some smooth functions <span class="math inline">\(a, b\)</span>.</p>
<p><span class="math display">\[
f(t, y) = a(t) y
\]</span></p>
<p><span class="math display">\[
\begin{align}
d X_t &amp;= \partial_1 f(t, Y_t) b(t) dB_t + \left( \partial_0 f(t, Y_t) + \frac{b(t)^2}{2} \partial_1^2 f(t, Y_t)\right) dt \\
&amp;= a(t) b(t) d B_t + a'(t)Y_tdt.
\end{align}
\]</span></p>
<p>Equating the drift terms gives <span class="math display">\[
a'(t) = \frac{a(t)}{t -2}.
\]</span></p>
<p>The solution is <span class="math display">\[
a(t) = C (t - 2)
\]</span> for a constant <span class="math inline">\(C\)</span>.</p>
<p>Equating the volatility terms gives</p>
<p><span class="math display">\[
a(t) b(t) = \sqrt{t(2 -t)}.
\]</span></p>
<p>We can write</p>
<p><span class="math display">\[
X_t = (2 - t) \int_0^t \sqrt{\frac{s}{2 -s}} d B_s.
\]</span></p>
<p>For each <span class="math inline">\(t \in [0, 1)\)</span>, <span class="math inline">\(X_t\)</span> has Gaussian distribution with mean zero, because it is a constant times a Wiener integral. The covariance is given by <span class="math display">\[
\begin{align}
\E(X_t X_s) &amp;= (2 -t) (2 -s) \int_0^s \frac{u}{2 -u} du \\
&amp;= (2 -t) (2 -s) \left( -s - 2\log(2 -s) + \log(4) \right) \\
&amp;= (2 -t) (2 -s) \left( \log\left(\frac{4}{(2-s)^2}\right) - s\right) \\
\end{align}
\]</span> for <span class="math inline">\(0 \leq s \leq t &lt; 1\)</span>.</p>
</section>
<section id="practice-on-sdes" class="level2">
<h2 class="anchored" data-anchor-id="practice-on-sdes">7.10 Practice on SDEs</h2>
<p>Let <span class="math inline">\(B_t\)</span> and <span class="math inline">\(C_t\)</span> be two independent Brownian motions. Let <span class="math inline">\(Y_t\)</span> be a continuous, apapted process. Let <span class="math display">\[
W_t = \int_0^t \frac{1}{\sqrt{1 + Y_s^2}} d B_s + \int_0^t \frac{Y_s}{\sqrt{1 + Y_s^2}} d C_s.
\]</span></p>
<section id="a-4" class="level4">
<h4 class="anchored" data-anchor-id="a-4">(a)</h4>
<p><span class="math inline">\(W_t\)</span> is a standard Brownian motion.</p>
<p>Proof:</p>
<p><span class="math inline">\(W_t\)</span> is the sum of two independent Gaussian processes with mean zero. Therefore, <span class="math inline">\(W_t\)</span> is a Gaussian process with mean zero.</p>
<p>For <span class="math inline">\(0 \leq s \leq t &lt; \infty\)</span> <span class="math display">\[
\begin{align}
\E(W_tW_s) &amp;= \E(\int_0^t \frac{1}{\sqrt{1 + Y_s^2}} d B_s\int_0^s \frac{1}{\sqrt{1 + Y_s^2}} d B_s) \\
&amp;+ \E(\int_0^t \frac{Y_s}{\sqrt{1 + Y_s^2}} d C_s \int_0^s \frac{Y_s}{\sqrt{1 + Y_s^2}} d C_s) \\
&amp;= \int_0^s \E(\frac{1}{1+ Y_u^2})  du + \int_0^s \E(\frac{Y_u^2}{1 + Y_u^2} ) du \\
&amp;= \int_0^s \E(\frac{1 + Y_u^2}{1 + Y_u^2}) du \\
&amp;= s.
\end{align}
\]</span></p>
<p>To complete the proof, it must be shown that <span class="math inline">\(W_t\)</span> is continuous. If we assume that <span class="math display">\[
\int_0^T \E(Y_s^2) ds &lt; \infty,
\]</span> then <span class="math display">\[
Y_t \in L^2_c(T).
\]</span> It follows that the Itô integrals which define <span class="math inline">\(W_t\)</span> are continous and so <span class="math inline">\(W_t\)</span> is continous. <span class="math display">\[
\qed
\]</span></p>
</section>
<section id="b-4" class="level4">
<h4 class="anchored" data-anchor-id="b-4">(b)</h4>
<p>Let</p>
<p><span class="math display">\[
X_t = \sinh(W_t) = \frac{e^{W_t} - e^{-W_t}}{2}.
\]</span></p>
<p><span class="math display">\[
f(t, x) = \sinh(x)
\]</span> and</p>
<p><span class="math display">\[
\partial_0 f(t, x) = 0,
\]</span> <span class="math display">\[
\partial_1 f(t, x) = \cosh(x),
\]</span> and <span class="math display">\[
\partial_1^2 f(t, x) = \sinh(x).
\]</span></p>
<p>Using Itô’s formula and the fact that <span class="math inline">\(W_t\)</span> is a standard Brownian motion <span class="math display">\[
\begin{align}
d X_t &amp;= \cosh(W_t) d W_t + \frac{1}{2} \sinh(W_t) dt \\
&amp;= \sqrt{1 + \sinh^2(W_t)} d W_t + \frac{1}{2} \sinh(W_t) dt \\
&amp;= \sqrt{1 + X_t^2} d W_t + \frac{X_t}{2} dt.
\end{align}
\]</span></p>
</section>
<section id="c-4" class="level4">
<h4 class="anchored" data-anchor-id="c-4">(c)</h4>
<p>The process <span class="math display">\[
Y_t = e^{C_t} \int_0^t e^{-C_s} dB_s
\]</span> satisfies the SDE <span class="math display">\[
\begin{align}
d Y_t = \sqrt{1 + Y_t^2} d W_t + \frac{Y_t}{2} dt, &amp;&amp; Y_0 = 1.
\end{align}
\]</span></p>
<p>Proof:</p>
<p>Note first that</p>
<p><span class="math display">\[
\sqrt{1 + Y_t^2} d W_t = d B_t + Y_t d C_t.
\]</span></p>
<p>Define</p>
<p><span class="math display">\[
U_t = e^{C_t},
\]</span> and <span class="math display">\[
V_t = \int_0^t e^{-C_s} dB_s,
\]</span> so that <span class="math display">\[
Y_t = U_t V_t.
\]</span> Using Itô’s formula <span class="math display">\[
dU_t = e^{C_t} d C_t + \frac{1}{2}e^{C_t} dt.
\]</span> Making use of the independence of <span class="math inline">\(B_t\)</span> and <span class="math inline">\(C_t\)</span>, <span class="math display">\[
\begin{align}
dY_t  &amp;= d(U_t V_t) \\
&amp;= V_t dU_t + U_t d V_t \\
&amp;= U_t V_t d C_t + \frac{1}{2} e^{C_t} V_t dt + dB_t \\
&amp;= Y_t d C_t + d B_t + \frac{1}{2} Y_t dt \\
&amp;= \sqrt{1 + Y_t^2} d W_t + \frac{1}{2} Y_t dt.
\end{align}
\]</span></p>
<p><span class="math display">\[
\qed
\]</span></p>
</section>
<section id="d-4" class="level4">
<h4 class="anchored" data-anchor-id="d-4">(d)</h4>
<p>For a standard Brownian motion <span class="math inline">\(W_t\)</span>, the SDE <span class="math display">\[
Y_t = \mu(Y_t) d W_t + \sigma(Y_t) dt
\]</span></p>
<p>has a unique solution (i.e if <span class="math inline">\(Y_t\)</span> and <span class="math inline">\(Y'_t\)</span> satisfy the SDE, then <span class="math display">\[
\P(Y_t = Y'_t) = 1
\]</span> for all <span class="math inline">\(t\)</span>), if <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\mu\)</span> grow not faster than <span class="math inline">\(Kx^2\)</span>, for some <span class="math inline">\(K &gt; 0\)</span> and are differentiable with bounded derivatives.</p>
<p>In the SDE considered here, <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span> satisfy the growth condition and have bounded derivatives:</p>
<p><span class="math display">\[
\mu'(x) = \frac{x}{\sqrt{1 + x^2}} \leq 1,
\]</span> and <span class="math display">\[
\sigma'(x) = 1/2.
\]</span></p>
<p>Therefore, the SDE has a unique solution: <span class="math inline">\(Y_t\)</span> and <span class="math inline">\(X_t\)</span> are both solutions so they must be equal with probability 1 for all <span class="math inline">\(t\)</span>.</p>
</section>
</section>
<section id="applications-of-lévys-characterisation" class="level2">
<h2 class="anchored" data-anchor-id="applications-of-lévys-characterisation">7.11 Applications of Lévy’s Characterisation</h2>
<p>Let <span class="math inline">\(B_t\)</span> be a Brownian motion in <span class="math inline">\(\mathbb{R}^d\)</span> for <span class="math inline">\(d &gt; 1\)</span>. The process <span class="math display">\[
R_t = \|B_t\|
\]</span> satisfies the SDE <span class="math display">\[
d R_t =d W_t + \frac{d -1}{2 R_t} dt,
\]</span> where</p>
<p><span class="math display">\[
d W_t = \sum_j \frac{B_t^{(j)}}{R_t} d B_t^{(j)}.
\]</span></p>
<p>The process <span class="math inline">\(W_t\)</span> is a standard Brownian motion.</p>
<p>Proof:</p>
<p>The Lévy characterisation can be leveraged: show that the quadratic variation satisfies <span class="math display">\[
\langle W \rangle_t = t
\]</span> and the fact that <span class="math inline">\(W_t\)</span> is a standard Brownian motion follows, so long as <span class="math inline">\(W_t\)</span> is a continous martingale with respect to the filtration <span class="math inline">\(\F_t\)</span>.</p>
<p><span class="math display">\[
\begin{align}
d\langle W \rangle_t &amp;= (d W_t)^2 \\
&amp;= \sum_{i,j} \frac{B_t^{(i)} B_t^{(j)}}{R_?t^2} dB_t^{(i)} d B_t^{(j)} \\
&amp;= \sum_i \frac{(B_t^{(i)})^2}{R_t^2} dt \\
&amp; = dt.
\end{align}
\]</span> That is, <span class="math display">\[
\langle W \rangle_t = t.
\]</span></p>
<p>To complete the proof, note that <span class="math inline">\(W_t\)</span> is a continous martingale.</p>
<p><span class="math display">\[
\qed
\]</span></p>
</section>
<section id="sde-of-the-bessel-process" class="level2">
<h2 class="anchored" data-anchor-id="sde-of-the-bessel-process">7.12 SDE of the Bessel Process</h2>
<p>Let</p>
<p><span class="math display">\[
f(x) = \|x\|.
\]</span></p>
<p>For <span class="math inline">\(i \geq 1\)</span>, <span class="math display">\[
\partial_i f(x) = \frac{x_i}{\|x\|},
\]</span> <span class="math display">\[
\partial_i^2 f(x) = \frac{1}{\|x\|} - \frac{x_i}{\|x\|^3},
\]</span> and <span class="math display">\[
\partial_0 f(x) = 0.
\]</span> Moreover, <span class="math display">\[
\Delta f(x) = \frac{d - 1}{\|x\|}.
\]</span></p>
<p>From the Itô formula</p>
<p><span class="math display">\[
\begin{align}
d R_t &amp;= d f(x) \\
&amp;= \sum_i \partial_i f(B_t) d B_t^{(i)} + \frac{1}{2}\Delta f(B_t) dt \\
&amp;= \sum_i \frac{B_t^{(i)}}{\|B_t\|} d B_t^{(i)} + \frac{d-1}{2 \|B_t\|} dt \\
&amp;= d W_t + \frac{d - 1}{2 \|R_t\|} dt.
\end{align}
\]</span></p>
</section>
<section id="conditional-itô-isometry" class="level2">
<h2 class="anchored" data-anchor-id="conditional-itô-isometry">7.13 Conditional Itô Isometry</h2>
<p>Let <span class="math inline">\((V_s, s \leq T)\)</span> be a process in <span class="math inline">\(\mathcal{S}(T)\)</span>. For <span class="math inline">\(t \leq t'\)</span>,</p>
<p><span class="math display">\[
\E\left(\left.\left\{ \int_0^{t'} V_s d B_s - \int_0^t V_s d B_s\right\}^2 - \int_t^{t'} V_s^2 ds \right\vert \F_t \right) = 0.
\]</span></p>
<p>Proof:</p>
<p>Let <span class="math inline">\((V_s) \in \mathcal{S}\)</span> so that</p>
<p><span class="math display">\[
V_s = \sum_i^{n-1} Y_i \mathbb{1}_{[t_i, t_{i+1})}(s)
\]</span> where <span class="math inline">\(Y_i\)</span> is <span class="math inline">\(\F_{t_i}\)</span> measurable. Without loss of generality, it can be assumed that <span class="math inline">\(t_k = t\)</span> for some <span class="math inline">\(k \leq n\)</span>: should <span class="math inline">\(t\)</span> not be one of <span class="math inline">\((t_i)\)</span>, it will be in some interval <span class="math inline">\([t_i, t_{i+1})\)</span> which can be split into two intervals creating an extra term in the defining sum of <span class="math inline">\(V_s\)</span>.</p>
<p>With this setup</p>
<p><span class="math display">\[
\begin{align}
\left\{\int_0^{t'} V_s d B_s - \int_0^t V_s d B_s\right\}^2 &amp;= \left\{\sum_{i=k} Y_i(B_{t_{i+1}} - B_{t_i}) \right\}^2 \\
&amp;= \sum_{i, j \geq k} Y_i Y_j (B_{t_{i+1}} - B_{t_i})(B_{t_{j+1}} - B_{t_j}).
\end{align}
\]</span></p>
<p>The terms of the RHS where <span class="math inline">\(i \leq j\)</span> will vanish when take the conditional expectation: <span class="math display">\[
\begin{align}
\E(\left. Y_i Y_j (B_{t_{i+1}} - B_{t_i})(B_{t_{j+1}} - B_{t_j})\right\vert\F_t) &amp;= \E(\left.\E(\left.Y_i Y_j (B_{t_{i+1}} - B_{t_i})(B_{t_{j+1}} - B_{t_j})\right\vert \F_{t_j})\right\vert \F_t) \\
&amp;=\E\left(\left.\underbrace{Y_i Y_j (B_{t_{i+1}} - B_{t_i})}_{\F_{t_j} \text{ measurable}}\underbrace{\E(\left. (B_{t_{j+1}} - B_{t_j}) \right\vert \F_{t_j})}_{= 0 \text{ by martingale property}} \right\vert \F_t\right) \\
&amp;= 0.
\end{align}
\]</span></p>
<p>This leaves only contribution of the square terms:</p>
<p><span class="math display">\[
\begin{align}
\E\left.\left(\left\{\int_0^{t'} V_s d B_s - \int_0^t V_s d B_s\right\}^2\right\vert \F_t\right) &amp;= \E\left(\left.\sum_{i=k} Y_i^2(B_{t_{i+1}} - B_{t_i})^2 \right\vert \F_t \right) \\
&amp;= \E\left(\left.\sum_{i=k} Y_i^2\E(\left.(B_{t_{i+1}} - B_{t_i})^2\right\vert \F_{t_i}) \right\vert \F_t \right) \\
&amp;= \E\left(\left.\sum_{i=k} Y_i^2(t_{i+1} - t_i) \right\vert \F_t \right) \\
&amp;= \sum_{i=k} \E(\left. Y_i^2 \right\vert \F_t) (t_{i+1} - t_i) \\
&amp;= \int_t^{t'} \E(\left. V_s^2 \right\vert \F_t) ds.
\end{align}
\]</span></p>
<p><span class="math display">\[
\qed
\]</span></p>
<p>The theorem can be extended for <span class="math inline">\(V = (V_t, t \leq T) \in L^2_c(T)\)</span> by approximating <span class="math inline">\(V\)</span> by simple functions in <span class="math inline">\(\mathcal{S}(T)\)</span>.</p>
<p><span class="math display">\[
\begin{align}
\E((\int_{t}^{t'} V_{n,s} dB_s)^2) \to \E((\int_t^{t'} V_s dB_s)^2)
\end{align}
\]</span> as <span class="math inline">\(n \to \infty\)</span>.</p>
<p>Moreover, <span class="math display">\[
\begin{align}
\E((\int_{t}^{t'} V_{n,s} dB_s)^2)  = \int_t^{t'} \E(V_{n,s}^2) \to \int_t^{t'} \E(V_s^2) ds
\end{align}
\]</span> as <span class="math inline">\(n \to \infty\)</span>.</p>
<p>Let <span class="math display">\[
I_{n,t'} = (\int_t^{t'} V_{n,s} d B_s)^2
\]</span> and <span class="math display">\[
R_{n,t'} = \int_t^{t'} \E(V_{n,s}^2) ds.
\]</span></p>
<p>For any <span class="math inline">\(A \in \F_t\)</span></p>
<p><span class="math display">\[
\begin{align}
\int_A \E(I_{n,t'} \vert \F_t) dP &amp;= \int_A I_{n,t'} dP \\
&amp;\to \int_A I_{t'} dP,
\end{align}
\]</span> and <span class="math display">\[
\begin{align}
\int_A E(R_{n, t'} \vert \F_t) dP &amp;= \int_A R_{n, t'} dP \\
&amp;\to \int_A R_{t'} dP.
\end{align}
\]</span></p>
<p>Since the isometry holds for <span class="math inline">\(I_{n, t'}\)</span> and <span class="math inline">\(R_{n,t'}\)</span>, the two limits are equal:</p>
<p><span class="math display">\[
\int_A I_{t'} dP =  \int_A R_{t'} dP
\]</span> for any <span class="math inline">\(A \in \F_t\)</span> which means, by definition, that <span class="math display">\[
\E( I_{t'} \vert \F_t) = \E(R_{t'}\vert \F_t )
\]</span> or, what is the same, <span class="math display">\[
\E\left(\left.\left\{ \int_0^{t'} V_s d B_s - \int_0^t V_s d B_s\right\}^2 - \int_t^{t'} V_s^2 ds \right\vert \F_t \right) = 0.
\]</span></p>
<p><span class="math display">\[
\qed
\]</span></p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>